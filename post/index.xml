<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts | Theo Sanderson</title><link>/post/</link><atom:link href="/post/index.xml" rel="self" type="application/rss+xml"/><description>Posts</description><generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><lastBuildDate>Fri, 22 Jan 2021 14:18:37 +0000</lastBuildDate><image><url>/images/icon_hu141e5746c4390abcaff97a6bd8371d9c_4466_512x512_fill_lanczos_center_2.png</url><title>Posts</title><link>/post/</link></image><item><title>New-variant compatibility in the ONS infection survey</title><link>/post/2021-01-22-ons-data/</link><pubDate>Fri, 22 Jan 2021 14:18:37 +0000</pubDate><guid>/post/2021-01-22-ons-data/</guid><description>&lt;p>&lt;small>Code behind this analysis: &lt;a href="https://github.com/theosanderson/theo.io/tree/master/content/post/2021-01-22-ons-data" class="uri">&lt;a href="https://github.com/theosanderson/theo.io/tree/master/content/post/2021-01-22-ons-data">https://github.com/theosanderson/theo.io/tree/master/content/post/2021-01-22-ons-data&lt;/a>&lt;/a>&lt;/small>&lt;/p>
&lt;p>The ONS infection survey has come out and there has been a lot of discussion on the apparent decrease in proportion of &amp;ldquo;new variant compatible&amp;rdquo; cases.&lt;/p>
&lt;p>&lt;img src="ons.png" alt="">&lt;/p>
&lt;p>To try to understand these patterns we need to go into a bit more detail. How are &amp;ldquo;new variant compatible&amp;rdquo; cases defined?&lt;/p>
&lt;p>The TaqPath tests that produce this data amplify parts of three genes in the SARS-CoV2 genome:&lt;/p>
&lt;ul>
&lt;li>The N gene&lt;/li>
&lt;li>ORF1ab&lt;/li>
&lt;li>The S gene&lt;/li>
&lt;/ul>
&lt;p>We know that B.1.1.7 often gives complete loss of the S-gene amplicon (data from Portugal suggest it doesn&amp;rsquo;t &lt;a href="https://virological.org/t/tracking-sars-cov-2-voc-202012-01-lineage-b-1-1-7-dissemination-in-portugal-insights-from-nationwide-rt-pcr-spike-gene-drop-out-data/600" target="_blank" rel="noopener">always&lt;/a>).&lt;/p>
&lt;p>When B.1.1.7 was emerging the ONS defined a fairly conservative definition of &amp;ldquo;new variant compatible&amp;rdquo; tests. They said that these must be positive for N, &lt;em>and&lt;/em> ORF1AB, but not for S. That is what we would expect to see for B.1.1.7 when there a lot of virions in the sample. But if a sample has a low number of virions, one or other of these genes might randomly drop below the detection threshold. Fortunately the ONS also report the data split out by each of the possible amplicon combinations, so we can examine this.&lt;/p>
&lt;p>First let&amp;rsquo;s convince ourselves that, irrespective of B.1.1.7, dropouts of amplicons can occur for various reasons. Let&amp;rsquo;s look at the distribution of amplicons period of time in September, before B.1.1.7 had really emerged.&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nv'>subset&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nv'>data&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>week&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"2020-09-21"&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>RegionType&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"EnglandRegion"&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>mutate&lt;/span>&lt;span class='o'>(&lt;/span>AmpliconType &lt;span class='o'>=&lt;/span> &lt;span class='nf'>case_when&lt;/span>&lt;span class='o'>(&lt;/span>
&lt;span class='nv'>Amplicons&lt;/span> &lt;span class='o'>%in%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/c.html'>c&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"N only"&lt;/span>,&lt;span class='s'>"N+S"&lt;/span>,&lt;span class='s'>"OR only"&lt;/span>,&lt;span class='s'>"OR+S"&lt;/span>,&lt;span class='s'>"S only"&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>~&lt;/span> &lt;span class='s'>"Random dropout"&lt;/span>,
&lt;span class='nv'>Amplicons&lt;/span> &lt;span class='o'>==&lt;/span> &lt;span class='s'>"OR+N+S"&lt;/span> &lt;span class='o'>~&lt;/span> &lt;span class='s'>"Definite non-B.1.1.7"&lt;/span>,
&lt;span class='nv'>Amplicons&lt;/span> &lt;span class='o'>==&lt;/span> &lt;span class='s'>"OR+N"&lt;/span> &lt;span class='o'>~&lt;/span> &lt;span class='s'>"Likely(?) B.1.1.7"&lt;/span>
&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>subset&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>AmpliconType&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Count&lt;/span>,fill&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Amplicons&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_bar&lt;/span>&lt;span class='o'>(&lt;/span>stat&lt;span class='o'>=&lt;/span>&lt;span class='s'>"identity"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>facet_wrap&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>~&lt;/span>&lt;span class='nv'>Region&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>theme_bw&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span> &lt;span class='nf'>theme&lt;/span>&lt;span class='o'>(&lt;/span>axis.text.x &lt;span class='o'>=&lt;/span> &lt;span class='nf'>element_text&lt;/span>&lt;span class='o'>(&lt;/span>angle &lt;span class='o'>=&lt;/span> &lt;span class='m'>90&lt;/span>, vjust &lt;span class='o'>=&lt;/span> &lt;span class='m'>0.5&lt;/span>, hjust&lt;span class='o'>=&lt;/span>&lt;span class='m'>1&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-2-1.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;/div>
&lt;p>I&amp;rsquo;ve separated out the &lt;code>OR+N&lt;/code> amplicon types, which the ONS considers new variannt compatible. Let&amp;rsquo;s ignore these for now. We can see that there is a substantial variation in the other amplicon groups. If there were no random dropout (and no other variants that compromise an assay), we would expect everything else to be &lt;code>OR+N+S&lt;/code>. But in the South West these make up a minority of the total positives identified. Instead it seems that some of these amplicons are randomly dropping out there.&lt;/p>
&lt;p>We can also see a lot of geographical heterogeneity in the level of this random dropout. What drives this? We also have the mean Ct values for each region so we can test the hypothesis that high Ct values (low number of virions), due to a higher proportion of infections being identified longer after the original infection, are responsible for the &amp;ldquo;random dropout&amp;rdquo;.&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='c'># Exclude suspected B.1.1.7 from the data&lt;/span>
&lt;span class='nv'>subset&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nv'>data&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>week&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"2020-09-21"&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>RegionType&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"EnglandRegion"&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>Amplicons&lt;/span>&lt;span class='o'>!=&lt;/span>&lt;span class='s'>"OR+S"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='c'>#Calculate the proportion with "no random dropout", then invert to get proportion of "random dropout"&lt;/span>
&lt;span class='nv'>subset&lt;/span> &lt;span class='o'>=&lt;/span>&lt;span class='nv'>subset&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>group_by&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>Region&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>mutate&lt;/span>&lt;span class='o'>(&lt;/span>proportion &lt;span class='o'>=&lt;/span> &lt;span class='nv'>Count&lt;/span>&lt;span class='o'>/&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/sum.html'>sum&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>Count&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>Amplicons&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"OR+N+S"&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>mutate&lt;/span>&lt;span class='o'>(&lt;/span>RandomDropout&lt;span class='o'>=&lt;/span>&lt;span class='m'>1&lt;/span>&lt;span class='o'>-&lt;/span>&lt;span class='nv'>proportion&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>subset_cts&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nv'>data_ct&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>week&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"2020-09-21"&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>RegionType&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"EnglandRegion"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>both&lt;/span> &lt;span class='o'>&amp;lt;-&lt;/span> &lt;span class='nf'>inner_join&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>subset&lt;/span>,&lt;span class='nv'>subset_cts&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='c'>#&amp;gt; Joining, by = c("Region", "RegionType", "week")&lt;/span>
&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>both&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Mean&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>RandomDropout&lt;/span>,label&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Region&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_point&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Mean Ct value"&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Proportion of 'random dropout'"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>theme_bw&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>scale_y_continuous&lt;/span>&lt;span class='o'>(&lt;/span>labels&lt;span class='o'>=&lt;/span>&lt;span class='nf'>scales&lt;/span>&lt;span class='nf'>::&lt;/span>&lt;span class='nv'>&lt;a href='https://scales.r-lib.org//reference/label_percent.html'>percent&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"Relationship between Ct and levels of random dropout in September"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-3-1.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;/div>
&lt;p>Having convinced ourselves that random dropouts can occur due at different levels due to differences in Ct values (and that Ct values &lt;a href="https://www.medrxiv.org/content/10.1101/2020.10.08.20204222v1" target="_blank" rel="noopener">can differ due to epidemiological dynamic&lt;/a>)), we can examine whether an increased rate of random dropouts in the N or ORF1ab genes (or both!) might cause an underestimation of B.1.1.7 prevalence when considering only &lt;code>OR+N+S&lt;/code> as compatible with the new variant.&lt;/p>
&lt;p>Now lets look at the trajectories of all amplicon groups over time in England.&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nv'>data&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nv'>data&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>group_by&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>Region&lt;/span>,&lt;span class='nv'>week&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>mutate&lt;/span>&lt;span class='o'>(&lt;/span>proportion &lt;span class='o'>=&lt;/span> &lt;span class='nv'>Count&lt;/span>&lt;span class='o'>/&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/sum.html'>sum&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>Count&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>data&lt;/span>&lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>Region&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"England"&lt;/span>&lt;span class='o'>)&lt;/span>, &lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>week&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>proportion&lt;/span>,color&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Amplicons&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_line&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>theme_bw&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>scale_y_continuous&lt;/span>&lt;span class='o'>(&lt;/span>labels&lt;span class='o'>=&lt;/span>&lt;span class='nf'>scales&lt;/span>&lt;span class='nf'>::&lt;/span>&lt;span class='nv'>&lt;a href='https://scales.r-lib.org//reference/label_percent.html'>percent&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-4-1.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;/div>
&lt;p>We can see a rise in &lt;code>OR+N&lt;/code> over time. But this seems to tail off to at least horizontal at the end. Does this mean that B.1.1.7 is no longer increasing at the expense of other variants? Well I don&amp;rsquo;t think we have evidence for this. &lt;code>OR+N&lt;/code> may be horizontal, but &lt;code>OR+N+S&lt;/code> seems likely to be falling faster. It is likely that this is due to a general change in the epidemic stage, as lockdown controls new infections and a higher proportion of old detections are detected. Again we can investigate this by looking at the Cts.&lt;/p>
&lt;p>Again if we want to look for an explanation we can investigate the Cts.&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>data_ct&lt;/span>&lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>RegionType&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"EnglandRegion"&lt;/span>&lt;span class='o'>)&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>week&lt;/span>, y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Mean&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_line&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span>&lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>title&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Regions"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>facet_wrap&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>~&lt;/span>&lt;span class='nv'>Region&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>theme_bw&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>y&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Mean Ct value"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-5-1.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;/div>
&lt;p>In all regions we see an increase in mean Ct over January, which we&amp;rsquo;d expect to cause more random dropouts, and reduce the number of both WT viruses that appear as &lt;code>OR+N+S&lt;/code> and of B.1.1.7 viruses that appear as &lt;code>OR+N&lt;/code>.&lt;/p>
&lt;p>One (imperfect) way to try to get a handle on this is to just plot the ratio of &lt;code>OR+N+S&lt;/code> to &lt;code>OR+N&lt;/code>, because both of these are affected by random drop out.&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>data&lt;/span>&lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>Region&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"England"&lt;/span>,&lt;span class='nv'>Amplicons&lt;/span> &lt;span class='o'>%in%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/c.html'>c&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"OR+N+S"&lt;/span>,&lt;span class='s'>"OR+N"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>week&lt;/span>, fill&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Amplicons&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Count&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_bar&lt;/span>&lt;span class='o'>(&lt;/span>stat&lt;span class='o'>=&lt;/span>&lt;span class='s'>"identity"&lt;/span>,position&lt;span class='o'>=&lt;/span>&lt;span class='s'>"fill"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>scale_y_continuous&lt;/span>&lt;span class='o'>(&lt;/span>labels&lt;span class='o'>=&lt;/span>&lt;span class='nf'>scales&lt;/span>&lt;span class='nf'>::&lt;/span>&lt;span class='nv'>&lt;a href='https://scales.r-lib.org//reference/label_percent.html'>percent&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span>&lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>title&lt;span class='o'>=&lt;/span>&lt;span class='s'>"England"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-6-1.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>
&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>data&lt;/span>&lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>RegionType&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"EnglandRegion"&lt;/span>,&lt;span class='nv'>Amplicons&lt;/span> &lt;span class='o'>%in%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/c.html'>c&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"OR+N+S"&lt;/span>,&lt;span class='s'>"OR+N"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>week&lt;/span>, fill&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Amplicons&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Count&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_bar&lt;/span>&lt;span class='o'>(&lt;/span>stat&lt;span class='o'>=&lt;/span>&lt;span class='s'>"identity"&lt;/span>,position&lt;span class='o'>=&lt;/span>&lt;span class='s'>"fill"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>scale_y_continuous&lt;/span>&lt;span class='o'>(&lt;/span>labels&lt;span class='o'>=&lt;/span>&lt;span class='nf'>scales&lt;/span>&lt;span class='nf'>::&lt;/span>&lt;span class='nv'>&lt;a href='https://scales.r-lib.org//reference/label_percent.html'>percent&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span>&lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>title&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Regions"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>facet_wrap&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>~&lt;/span>&lt;span class='nv'>Region&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-6-2.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;/div>
&lt;p>Similarly we can also plot how the proportion of B.1.1.7 incompatible cases (those that do show S amplification) has changed.&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nv'>data&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nv'>data&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>mutate&lt;/span>&lt;span class='o'>(&lt;/span>B117_incompatible &lt;span class='o'>=&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/grep.html'>grepl&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>'S'&lt;/span>,&lt;span class='nv'>Amplicons&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>data&lt;/span>&lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>Region&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"England"&lt;/span>,&lt;span class='nv'>Amplicons&lt;/span> &lt;span class='o'>%in%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/c.html'>c&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"OR+N+S"&lt;/span>,&lt;span class='s'>"OR+N"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>week&lt;/span>, fill&lt;span class='o'>=&lt;/span>&lt;span class='nv'>B117_incompatible&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Count&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_bar&lt;/span>&lt;span class='o'>(&lt;/span>stat&lt;span class='o'>=&lt;/span>&lt;span class='s'>"identity"&lt;/span>,position&lt;span class='o'>=&lt;/span>&lt;span class='s'>"fill"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>scale_y_continuous&lt;/span>&lt;span class='o'>(&lt;/span>labels&lt;span class='o'>=&lt;/span>&lt;span class='nf'>scales&lt;/span>&lt;span class='nf'>::&lt;/span>&lt;span class='nv'>&lt;a href='https://scales.r-lib.org//reference/label_percent.html'>percent&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span>&lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>title&lt;span class='o'>=&lt;/span>&lt;span class='s'>"England"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-7-1.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>
&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>data&lt;/span>&lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>RegionType&lt;/span>&lt;span class='o'>==&lt;/span>&lt;span class='s'>"EnglandRegion"&lt;/span>,&lt;span class='nv'>Amplicons&lt;/span> &lt;span class='o'>%in%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/c.html'>c&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"OR+N+S"&lt;/span>,&lt;span class='s'>"OR+N"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>week&lt;/span>, fill&lt;span class='o'>=&lt;/span>&lt;span class='nv'>B117_incompatible&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Count&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_bar&lt;/span>&lt;span class='o'>(&lt;/span>stat&lt;span class='o'>=&lt;/span>&lt;span class='s'>"identity"&lt;/span>,position&lt;span class='o'>=&lt;/span>&lt;span class='s'>"fill"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>scale_y_continuous&lt;/span>&lt;span class='o'>(&lt;/span>labels&lt;span class='o'>=&lt;/span>&lt;span class='nf'>scales&lt;/span>&lt;span class='nf'>::&lt;/span>&lt;span class='nv'>&lt;a href='https://scales.r-lib.org//reference/label_percent.html'>percent&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span>&lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>title&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Regions"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>facet_wrap&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>~&lt;/span>&lt;span class='nv'>Region&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-7-2.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;/div>
&lt;p>to be continued&lt;/p></description></item><item><title>Investigating the latest round of REACT</title><link>/post/2021-01-21-react/</link><pubDate>Thu, 21 Jan 2021 17:58:37 +0000</pubDate><guid>/post/2021-01-21-react/</guid><description>&lt;p>The &lt;a href="https://spiral.imperial.ac.uk/handle/10044/1/85583" target="_blank" rel="noopener">latest round of the REACT study&lt;/a> has come out, and been quite controversial. Let&amp;rsquo;s examine some of the raw data behind it.&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='kr'>&lt;a href='https://rdrr.io/r/base/library.html'>library&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>&lt;a href='http://tidyverse.tidyverse.org'>tidyverse&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>Let&amp;rsquo;s download the REACT data and process it into a nice format:&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nv'>positive&lt;/span> &lt;span class='o'>&amp;lt;-&lt;/span> &lt;span class='nf'>read_csv&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/connections.html'>url&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"https://raw.githubusercontent.com/mrc-ide/reactidd/master/inst/extdata/positive.csv"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='c'>#&amp;gt; Warning: Missing column names filled in: 'X1' [1]&lt;/span>
&lt;span class='nv'>total&lt;/span> &lt;span class='o'>&amp;lt;-&lt;/span> &lt;span class='nf'>read_csv&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/connections.html'>url&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"https://raw.githubusercontent.com/mrc-ide/reactidd/master/inst/extdata/total.csv"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='c'>#&amp;gt; Warning: Missing column names filled in: 'X1' [1]&lt;/span>
&lt;/code>&lt;/pre>
&lt;/div>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nv'>positive&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>type&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='s'>"positive"&lt;/span>
&lt;span class='nv'>total&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>type&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='s'>"total"&lt;/span>
&lt;span class='nv'>all&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nf'>bind_rows&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>positive&lt;/span>, &lt;span class='nv'>total&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/colnames.html'>colnames&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>all&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>[&lt;/span>&lt;span class='m'>1&lt;/span>&lt;span class='o'>]&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='s'>"Date"&lt;/span>
&lt;span class='nv'>all&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nv'>all&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>pivot_longer&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/c.html'>c&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>-&lt;/span>&lt;span class='nv'>Date&lt;/span>,&lt;span class='o'>-&lt;/span>&lt;span class='nv'>type&lt;/span>&lt;span class='o'>)&lt;/span>,names_to&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Region"&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>pivot_wider&lt;/span>&lt;span class='o'>(&lt;/span>names_from&lt;span class='o'>=&lt;/span>&lt;span class='nv'>type&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>all&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'># A tibble: 1,485 x 4&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; Date Region positive total&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;font-style: italic;'>&amp;lt;date&amp;gt;&lt;/span>&lt;span> &lt;/span>&lt;span style='color: #555555;font-style: italic;'>&amp;lt;chr&amp;gt;&lt;/span>&lt;span> &lt;/span>&lt;span style='color: #555555;font-style: italic;'>&amp;lt;dbl&amp;gt;&lt;/span>&lt;span> &lt;/span>&lt;span style='color: #555555;font-style: italic;'>&amp;lt;dbl&amp;gt;&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 1&lt;/span>&lt;span> 2020-05-05 South East 0 113&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 2&lt;/span>&lt;span> 2020-05-05 North East 0 13&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 3&lt;/span>&lt;span> 2020-05-05 North West 1 73&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 4&lt;/span>&lt;span> 2020-05-05 Yorkshire and The Humber 0 33&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 5&lt;/span>&lt;span> 2020-05-05 East Midlands 1 77&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 6&lt;/span>&lt;span> 2020-05-05 West Midlands 0 51&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 7&lt;/span>&lt;span> 2020-05-05 East of England 0 93&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 8&lt;/span>&lt;span> 2020-05-05 London 0 39&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 9&lt;/span>&lt;span> 2020-05-05 South West 0 42&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'>10&lt;/span>&lt;span> 2020-05-06 South East 0 62&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'># … with 1,475 more rows&lt;/span>&lt;/span>m
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>Now we can calculate binomial confidence intervals by location for each date and plot them.&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nv'>all&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nv'>all&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>!&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/NA.html'>is.na&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>positive&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>!&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/NA.html'>is.na&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>total&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='kr'>&lt;a href='https://rdrr.io/r/base/library.html'>library&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>binom&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>cis&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/pkg/binom/man/binom.confint.html'>binom.confint&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>all&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>positive&lt;/span>,&lt;span class='nv'>all&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>total&lt;/span>, method&lt;span class='o'>=&lt;/span>&lt;span class='s'>"exact"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>all&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>lower&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nv'>cis&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>lower&lt;/span>
&lt;span class='nv'>all&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>mean&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nv'>cis&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>mean&lt;/span>
&lt;span class='nv'>all&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>upper&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nv'>cis&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>upper&lt;/span>
&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>all&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>Date&lt;/span>&lt;span class='o'>&amp;gt;&lt;/span>&lt;span class='s'>"2020-12-15"&lt;/span>&lt;span class='o'>)&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Date&lt;/span>,ymin&lt;span class='o'>=&lt;/span>&lt;span class='nv'>lower&lt;/span>,ymax&lt;span class='o'>=&lt;/span>&lt;span class='nv'>upper&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>mean&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_pointrange&lt;/span>&lt;span class='o'>(&lt;/span>color&lt;span class='o'>=&lt;/span>&lt;span class='s'>"black"&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span>&lt;span class='nf'>facet_wrap&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>~&lt;/span>&lt;span class='nv'>Region&lt;/span>,scales&lt;span class='o'>=&lt;/span>&lt;span class='s'>"free_y"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>scale_y_log10&lt;/span>&lt;span class='o'>(&lt;/span>labels &lt;span class='o'>=&lt;/span> &lt;span class='nf'>scales&lt;/span>&lt;span class='nf'>::&lt;/span>&lt;span class='nv'>&lt;a href='https://scales.r-lib.org//reference/label_percent.html'>percent&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>theme_bw&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span> &lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>y&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Probability of testing positive"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='c'>#&amp;gt; Warning: Transformation introduced infinite values in continuous y-axis&lt;/span>
&lt;span class='c'>#&amp;gt; Warning: Transformation introduced infinite values in continuous y-axis&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-4-1.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>
&lt;span class='nf'>ggsave&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"plot.png"&lt;/span>,width&lt;span class='o'>=&lt;/span>&lt;span class='m'>9&lt;/span>,height&lt;span class='o'>=&lt;/span>&lt;span class='m'>5&lt;/span>, type&lt;span class='o'>=&lt;/span>&lt;span class='s'>"cairo"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='c'>#&amp;gt; Warning: Transformation introduced infinite values in continuous y-axis&lt;/span>
&lt;span class='c'>#&amp;gt; Warning: Transformation introduced infinite values in continuous y-axis&lt;/span>
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>This looks to accord well with the table of R values that REACT provide in Table 3: &lt;img src="react-table.png" alt="">&lt;/p>
&lt;p>This isn&amp;rsquo;t especially surprising, but I think the visualisation helps to make sense of how these values came to be calculated (even though they are probably based on a more complex analysis weighting for various demographic factors).&lt;/p>
&lt;p>That&amp;rsquo;s it for now.&lt;/p></description></item><item><title>The virus vs. the vaccine</title><link>/post/2021-01-21-vaccine-virus/</link><pubDate>Thu, 21 Jan 2021 16:58:37 +0000</pubDate><guid>/post/2021-01-21-vaccine-virus/</guid><description>&lt;p>One framing for thinking about COVID is as a race between vaccination and infection, since we expect the former to have at least some mitigating effect on the latter. To get a sense for this I plot the cumulative infection estimates from the &lt;a href="https://www.mrc-bsu.cam.ac.uk/tackling-covid-19/nowcasting-and-forecasting-of-covid-19/" target="_blank" rel="noopener">MRC Biostatistics Nowcasting Reports&lt;/a> against the vaccination numbers from &lt;a href="https://coronavirus.data.gov.uk/details/healthcare" target="_blank" rel="noopener">PHE&lt;/a> (with historical data filled in from &lt;a href="https://ourworldindata.org/covid-vaccinations" target="_blank" rel="noopener">Our World in Data&lt;/a>).&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='kr'>&lt;a href='https://rdrr.io/r/base/try.html'>try&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='kr'>&lt;a href='https://rdrr.io/r/base/library.html'>library&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>&lt;a href='http://tidyverse.tidyverse.org'>tidyverse&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span>, silent&lt;span class='o'>=&lt;/span>&lt;span class='kc'>TRUE&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='kr'>&lt;a href='https://rdrr.io/r/base/library.html'>library&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>&lt;a href='https://arxiv.org/abs/1403.2805'>jsonlite&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='kr'>&lt;a href='https://rdrr.io/r/base/library.html'>library&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>&lt;a href='http://github.com/jrnold/ggthemes'>ggthemes&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>a&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/pkg/jsonlite/man/fromJSON.html'>fromJSON&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"mrc_biostats.json"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>df&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nf'>tibble&lt;/span>&lt;span class='o'>(&lt;/span>date&lt;span class='o'>=&lt;/span>&lt;span class='nv'>a&lt;/span>&lt;span class='o'>[[&lt;/span>&lt;span class='m'>1&lt;/span>&lt;span class='o'>]&lt;/span>&lt;span class='o'>]&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>a&lt;/span>&lt;span class='o'>[[&lt;/span>&lt;span class='m'>2&lt;/span>&lt;span class='o'>]&lt;/span>&lt;span class='o'>]&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>df&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>date&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nf'>lubridate&lt;/span>&lt;span class='nf'>::&lt;/span>&lt;span class='nf'>&lt;a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>df&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>date&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>df&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>label&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='s'>"People infected"&lt;/span>
&lt;span class='nv'>b&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nf'>read_csv&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"vaccinations.csv"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>b&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>y&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nv'>b&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>numFirstDose&lt;/span>
&lt;span class='nv'>b&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>date&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nf'>lubridate&lt;/span>&lt;span class='nf'>::&lt;/span>&lt;span class='nf'>&lt;a href='http://lubridate.tidyverse.org/reference/ymd.html'>dmy&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>b&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>date&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>b&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>label&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='s'>"People vaccinated"&lt;/span>
&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nf'>bind_rows&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>df&lt;/span>,&lt;span class='nv'>b&lt;/span>&lt;span class='o'>)&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>date&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>y&lt;/span>&lt;span class='o'>/&lt;/span>&lt;span class='m'>1000000&lt;/span>,color&lt;span class='o'>=&lt;/span>&lt;span class='nv'>label&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_line&lt;/span>&lt;span class='o'>(&lt;/span>size&lt;span class='o'>=&lt;/span>&lt;span class='m'>1&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span>&lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Date"&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Number of people (millions)"&lt;/span>,color&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Type"&lt;/span>,title&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Infection and vaccination levels in England"&lt;/span>,caption&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Data sources: MRC Biostatistics Unit (cumulative infection estimates)\nOur World In Data &amp;amp; PHE (vaccination figures – at least one dose)"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/pkg/ggthemes/man/theme_hc.html'>theme_hc&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>+
&lt;span class='nf'>theme&lt;/span>&lt;span class='o'>(&lt;/span>plot.title &lt;span class='o'>=&lt;/span> &lt;span class='nf'>element_text&lt;/span>&lt;span class='o'>(&lt;/span>hjust &lt;span class='o'>=&lt;/span> &lt;span class='m'>0.5&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-1-1.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nf'>ggsave&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"plot.png"&lt;/span>,width&lt;span class='o'>=&lt;/span>&lt;span class='m'>7.3&lt;/span>,height&lt;span class='o'>=&lt;/span>&lt;span class='m'>4&lt;/span>, type &lt;span class='o'>=&lt;/span> &lt;span class='s'>"cairo"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>If we literally were to imagine vaccination and infection to be mutually exclusive (which clearly isn&amp;rsquo;t true in either direction), we could plot a graph like this to look at where they might meet.&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>
&lt;span class='nv'>c&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nv'>b&lt;/span>
&lt;span class='nv'>c&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>label&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='s'>"People unvaccinated"&lt;/span>
&lt;span class='nv'>c&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>y&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='m'>56000000&lt;/span>&lt;span class='o'>-&lt;/span>&lt;span class='nv'>c&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>y&lt;/span>
&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nf'>bind_rows&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>df&lt;/span>,&lt;span class='nv'>c&lt;/span>&lt;span class='o'>)&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>date&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>y&lt;/span>&lt;span class='o'>/&lt;/span>&lt;span class='m'>1000000&lt;/span>,color&lt;span class='o'>=&lt;/span>&lt;span class='nv'>label&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_line&lt;/span>&lt;span class='o'>(&lt;/span>size&lt;span class='o'>=&lt;/span>&lt;span class='m'>1&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span>&lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Date"&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Number of people (millions)"&lt;/span>,color&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Type"&lt;/span>,title&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Infection and vaccination levels in England"&lt;/span>,caption&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Data sources: MRC Biostatistics Unit (cumulative infection estimates)\nOur World In Data &amp;amp; PHE (vaccination figures – at least one dose)"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/pkg/ggthemes/man/theme_hc.html'>theme_hc&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>+
&lt;span class='nf'>theme&lt;/span>&lt;span class='o'>(&lt;/span>plot.title &lt;span class='o'>=&lt;/span> &lt;span class='nf'>element_text&lt;/span>&lt;span class='o'>(&lt;/span>hjust &lt;span class='o'>=&lt;/span> &lt;span class='m'>0.5&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-2-1.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>
&lt;span class='nf'>ggsave&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"plot2.png"&lt;/span>,width&lt;span class='o'>=&lt;/span>&lt;span class='m'>7.3&lt;/span>,height&lt;span class='o'>=&lt;/span>&lt;span class='m'>4&lt;/span>, type &lt;span class='o'>=&lt;/span> &lt;span class='s'>"cairo"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;/div></description></item><item><title>COVID-19 and the categorical imperative</title><link>/blog/2020/04/21/covid-19-and-the-categorical-imperative/</link><pubDate>Tue, 21 Apr 2020 13:26:41 +0000</pubDate><guid>/blog/2020/04/21/covid-19-and-the-categorical-imperative/</guid><description>&lt;p>I recently asked on Twitter:&lt;figure class="wp-block-image is-resized">&lt;/p>
&lt;p>&lt;img style="border:1px solid #DDD" src="/post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image.png" /> &lt;/figure>&lt;/p>
&lt;p>And got reassuring results:&lt;figure class="wp-block-image is-resized">&lt;/p>
&lt;p>&lt;img style="border:1px solid #DDD" src="/post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image-1.png" alt="" class="wp-image-377" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image-1.png 476w, /post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image-1-300x67.png 300w" sizes="(max-width: 476px) 85vw, 476px" /> &lt;/figure>&lt;/p>
&lt;p>Then I asked another question. Have a think about how you might answer it.&lt;figure class="wp-block-image is-resized">&lt;/p>
&lt;p>&lt;img style="border:1px solid #DDD" src="/post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image-2.png" alt="" class="wp-image-378" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image-2.png 475w, /post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image-2-300x171.png 300w" sizes="(max-width: 475px) 85vw, 475px" /> &lt;/figure>&lt;/p>
&lt;p>Here is how Twitter responded:&lt;figure class="wp-block-image">&lt;/p>
&lt;p>&lt;img style="border:1px solid #DDD" src="/post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image-4.png" alt="" class="wp-image-381" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image-4.png 425w, /post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image-4-300x62.png 300w" sizes="(max-width: 425px) 85vw, 425px" /> &lt;/figure>&lt;/p>
&lt;p>Quite a difference! Not surprising perhaps. The risk of passing on COVID-19 is lower by a factor of 12,000. Nevertheless, I think that the good people of Twitter are wrong, and will explain why a little further down.&lt;/p>
&lt;p>The people of Twitter are not alone though, and these sorts of decisions aren’t just thought experiments. The UK government first required people with coughs or fever to isolate themselves on 12 March, long after the virus arrived in the UK. This was part of the government’s strategy of introducing “the right measures at the right time”, and Sir Patrick Vallance gave this as an example, saying that prior to 12 March a very small proportion of people with symptoms would have COVID-19, so it would not make sense to isolate them.&lt;/p>
&lt;p>I’ve seen a similar argument made against mask use. After lockdown a small proportion of people will have COVID, the argument goes, so the chance of any particular mask stopping an infection is tiny:&lt;figure class="wp-block-image">&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image-5.png" alt="" class="wp-image-385" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image-5.png 477w, /post/archive_posts/old_wp_images/wp-content/uploads/2020/04/image-5-300x126.png 300w" sizes="(max-width: 477px) 85vw, 477px" /> &lt;/figure>&lt;/p>
&lt;p>We do this sort of risk analysis all the time. When you go somewhere in a car there is some small chance you could cause an accident in which someone is hurt, but if that risk were 12,000 times higher you would never drive again.&lt;/p>
&lt;p>Even some experts appear to agree:&lt;figure class="wp-block-image is-resized">&lt;/p>
&lt;p>&lt;img src="https://pbs.twimg.com/media/EWHRh0OXQAAnd01?format=jpg&amp;name=large" alt="Image" width="426" height="292" /> &lt;figcaption>From &lt;a href="https://www.thetimes.co.uk/article/facemasks-for-public-risk-nhs-shortage-q5bkzvzql" target="_blank" rel="noopener">The Times, 21st April&lt;/a>&lt;/figcaption>&lt;/figure>&lt;/p>
&lt;p>But this argument does not apply for a contagious virus.&lt;/p>
&lt;h3 id="investigating-with-a-simple-model">Investigating with a simple model&lt;/h3>
&lt;p>Practically, someone who stays home in Scenario A (when there is a 99.999% chance they have a cold), has the same impact as someone who stays home when there is a 12% chance they have COVID. One way to see this is to simulate an epidemic, and imagine that we institute an intervention for only a week, either early in the epidemic or late in the epidemic.&lt;/p>
&lt;p>Let’s consider the mass-masking scenario. Without any interventions, each infected person passes the virus on to 2.5 additional people. We’ll exaggerate the effect of masks and imagine that everyone wearing masks reduces that number (R) to 0.8. In reality this magnitude of effect could only be achieved with a package of many interventions. But it makes it easier to see what’s going on with a graph.&lt;/p>
&lt;p>If we plot the epidemic with a logarithmic y-axis, then the steepness of the line is a reflection of how many people each infected person passes the virus to. So if we don’t implement any interventions, this graph goes up with a constant slope.&lt;figure class="wp-block-image">&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2020/04/step1.gif" alt="" class="wp-image-396" /> &lt;/figure>&lt;/p>
&lt;p>What happens if we wait until lots of people have the virus, and then bring in masks for 2 weeks to try to stop them passing it on? Well, it’s as you’d expect. The graph goes up as normal, then goes down as R falls to 0.8 for 2 weeks, then starts going up at the same rate again, but reaches a lower point after 80 days than without the two week intervention.&lt;figure class="wp-block-image">&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2020/04/step2.gif" alt="" class="wp-image-397" /> &lt;/figure>&lt;/p>
&lt;p>In this case we decided to bring in the 2 week intervention only after at least 1% of people were infected. This seems to make sense. Surely there is no point in making people wear masks when only 0.001% of them have the virus? But let’s check, what happens if we bring in the two weeks much earlier in the epidemic?&lt;figure class="wp-block-image">&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2020/04/step3.gif" alt="" class="wp-image-398" /> &lt;/figure>&lt;/p>
&lt;p>It turns out that the two weeks early in the epidemic has exactly the same effect on the number of infections on day 80! What matters is that it has the same effect on R in either case. Even though a far lower absolute number of infected people are wearing masks, R is reduced to 0.8 in both cases.&lt;/p>
&lt;h3 id="ethics-how-should-we-each-act-in-the-time-of-covid-19">Ethics: how should we each act in the time of COVID-19?&lt;/h3>
&lt;p>As COVID-19 was spreading in our communities, many people advocated for social-distancing measures. One model for doing this is to think about the absolute chance you have of spreading the virus. For example, someone made a graph to discourage people from holding large events by showing that if there are a lot of infections in the community there is a good chance that large events will cause transmission events:&lt;figure class="wp-block-image">&lt;/p>
&lt;p>&lt;img src="https://pbs.twimg.com/media/EV5HbwjVAAYZbz0?format=jpg&amp;amp;name=4096x4096" alt="Image"> &lt;/figure>&lt;/p>
&lt;p>Interestingly this graph suggests that if one holds a large event when there is a low level of COVID in the community, there is a less negative effect than when there is a high level. But we’ve seen from the models above that this isn’t correct.&lt;/p>
&lt;p>So how can we decide how to shape our behaviour? I think it makes sense to follow Kant’s “&lt;a href="https://en.wikipedia.org/wiki/Categorical_imperative" target="_blank" rel="noopener">Categorical Imperative&lt;/a>“.&lt;/p>
&lt;blockquote class="wp-block-quote">
&lt;p>
&lt;strong>Act only according to that&amp;nbsp;maxim&amp;nbsp;whereby you can, at the same time, will that it should become a universal law.&lt;/strong>
&lt;/p>
&lt;/blockquote>
&lt;p>So imagine if everyone acted as you intend to, and work out what the effect on R would be. If everyone wears masks then, regardless of the level of COVID in the community, R is reduced. If everyone holds large events then, regardless of the level of COVID in the community, R is increased.&lt;/p>
&lt;p>In the absence of evidence on seroprevalence and immunity, we must aim to keep R below 1 until we have a vaccine. This will drive the level in the community down to near zero. It will allow vulnerable people to go about their lives as normal. However to achieve these levels we must sustain our measures &lt;em>even as levels in the community drop&lt;/em>. Even as we believe that only 30 people in the whole country are infected, we must all wear masks. It’s counter-intuitive, but it will work.&lt;/p></description></item><item><title>Community testing for COVID-19: reaching 25 million tests per week</title><link>/blog/2020/04/19/community-testing-for-covid-19-reaching-25-million-tests-per-week/</link><pubDate>Sun, 19 Apr 2020 13:28:46 +0000</pubDate><guid>/blog/2020/04/19/community-testing-for-covid-19-reaching-25-million-tests-per-week/</guid><description>&lt;p>Until recently, the strategy for COVID testing in many countries has been focused on people who have a significantly likelihood of having COVID-19. The need to impose unpleasant social distancing measures, and ultimately complete lock-downs, trades off against how much testing you do in the community. With sufficient community testing, you could suppress COVID in a population without any social distancing measures. This post is an outline of one way one might go about testing 25 million people per week in order to achieve this.&lt;/p>
&lt;h3 id="decentralised-testing">&lt;strong>Decentralised testing&lt;/strong>&lt;/h3>
&lt;p>Reaching this sort of scale quickly is likely to require a decentralised approach levering existing organisations. The most obvious candidates to do this are schools and larger businesses. Thirteen million people are employed by businesses with more than 50 employees, and there are twelve million children in schools. If these businesses and schools could test everyone within them each week, 25 million tests would be carried out.&lt;/p>
&lt;p>It’s important to note that this sort of testing is completely different from the testing of symptomatic, or likely infected, individuals. Symptomatic testing rightly requires specialist training, uncomfortable nasopharyngeal swabs, and full PPE for the person testing and the person being tested. This is because there is a high risk of exposure to COVID-19, and because getting a test result wrong could have major implications for care.&lt;/p>
&lt;p>Testing random individuals from a population with low incidence of COVID-19 poses no greater risk than interacting with them in any other way, as colleagues or students. And in this setting a significant rate of false-negatives or false-positives can be tolerated without major consequences.&lt;/p>
&lt;h3 id="testing-procedure">Testing procedure&lt;/h3>
&lt;p>In this proposal all of these businesses and schools would be supplied with: simple nasal swabs, frozen plates containing COVID-19 RT-PCR mix, a basic one-button thermocycler, a blue light transilluminator.&lt;/p>
&lt;p>The employee responsible for testing takes one of the frozen plates out of the freezer and thaws it.&lt;/p>
&lt;p>Students and employees go up, one by one, to the testing station. Each person takes a nasal swab and swabs their nostril (front-of-nose, not nasopharyx), then places the swab into a well of the plate, and cuts off the swab’s shaft and discards it. They also write their name on a sheet in a box representing this well, then wash their hands.&lt;/p>
&lt;p>Once the plate is full of samples the employee responsible for testing takes the plate. They seal it, load it into the one-button-thermocycler, and press the button. The thermocycler runs an RT-PCR programme for an hour.&lt;/p>
&lt;p>The employee takes the plate out of the machine and examines it with the blue light transilluminator. Any positive wells (including a pre-loaded control well) will glow brightly. Negative wells will be dull.&lt;/p>
&lt;p>If the employee notices any positive wells (a very rare occurence) they immediately look at the sheet of names and contact the person in question to ask them to report to public health authorities for confirmatory testing. If this test comes back positive then contact-tracing begins.&lt;/p>
&lt;p>The aim would be to test each person at these schools and businesses once each week.&lt;/p>
&lt;h3 id="costs-and-availability">Costs and availability&lt;/h3>
&lt;p>The reagents for this test cost much less that £1 per tested person.&lt;/p>
&lt;p>A thermocycler is a simple device which can be currently be purchased for £3,200, and likely manufactured for much less. Unlike ventilators, these could be relatively easily produced by other manufacturers. There would be a definite need to scale up production to achieve this scale.&lt;/p>
&lt;p>A blue light transilluminator can be made for less than £40 from commonly available materials.&lt;/p>
&lt;p>It seems likely that, despite their low-cost, global supplies of RT-PCR enzymes are insufficient for this scale of testing at present. But there is no reason I am aware of to think that this could not easily be scaled up. The quantities of primers needed are readily available.&lt;/p>
&lt;p>There might be a need to scale up the production of the DNA-binding dye.&lt;/p>
&lt;p>All of these costs are minuscule compared to the economic losses averted by preventing a lock-down.&lt;/p></description></item><item><title>Controlled infection with COVID-19 as a safer means of establishing herd immunity</title><link>/blog/2020/03/14/controlled-infection-with-covid-19-as-a-safer-means-of-establishing-herd-immunity/</link><pubDate>Sat, 14 Mar 2020 13:04:28 +0000</pubDate><guid>/blog/2020/03/14/controlled-infection-with-covid-19-as-a-safer-means-of-establishing-herd-immunity/</guid><description>&lt;p>&lt;strong>Update: it seems (although clarity is lacking) that the UK has moved away from the herd-immunity strategy.&lt;/strong> &lt;strong>I very much welcome this. It renders the argument below irrelevant, except as an illustration of the weaknesses of a strategy that seeks to vaccinate a population using an epidemic.&lt;/strong>&lt;/p>
&lt;p style="background-color:#fffce9" class="has-background">
Disclaimer: I am neither a virologist, nor an immunologist, nor an epidemiologist. This post is written with confidence, because too many caveats hinder clarity, but should be understood to be the thoughts of a layperson.
&lt;/p>
&lt;p>This week the policy of the UK government on COVID-19, under advice from scientists, has been articulated clearly for the first time. The government intends for around 60% of the population to be infected with COVID-19 in the anticipation that after the majority who survive recover, the population as a whole will have ‘herd immunity’ to the virus, since if only 40% of the population can pass on the virus it will be unable to spread.&lt;/p>
&lt;p>One can argue about the wisdom of the policy, which is in disagreement with the position of the WHO and many other countries. This post is not about that. What I am interested in is: &lt;strong>given this policy (to allow 60% of the population to become infected)&lt;/strong>, what is the least bad way to achieve this? For instance, should you let the virus spread at random through the population or should you actively infect people with the virus under very controlled conditions to minimise the risks?&lt;/p>
&lt;p>&lt;strong>&lt;span style="text-decoration: underline;">The current approach&lt;/span>&lt;/strong>&lt;/p>
&lt;p>The government’s approach is to allow the virus to spread with relatively few restrictions initially. At a point before it overwhelms the healthcare system, it will introduce further social-distancing measures to attempt to “flatten the curve” and spread the 40 million infections over a longer time. There will also be some measures to try to ensure that the most vulnerable – older and immunocompromised people – are isolated, but it is unclear how effectively this can be achieved.&lt;/p>
&lt;p>&lt;strong>&lt;span style="text-decoration: underline;">Risks of the current approach&lt;/span>&lt;/strong>&lt;/p>
&lt;p>**Infecting the vulnerable. ~**20% of the UK population is over 65. The fatality rate appears at least 10x higher in this demographic group, hence the government’s attempts to isolate them. At a point where a substantial portion of the population has the virus it is likely to be very difficult to achieve this. If the 60% of the 3.2 million people over 80 became infected, and the fatality rate of 14% for this age-group from China applied then that would represent 270,000 deaths in this age group alone.&lt;/p>
&lt;p>&lt;strong>Overloading the healthcare system.&lt;/strong> Exponential growth is a powerful adversary and small miscalculations could result in overloading the healthcare system with the result that many people die simply because there are no ventilators available to keep them alive. There is concern among some experts that it will not be possible to flatten the curve enough to ensure that  everyone receives adequate care. Exponential growth is difficult to avoid in natural infections because people who get the virus will not initially know that they have it, and so will unknowingly spread it to others.&lt;/p>
&lt;p>&lt;strong>Viral load.&lt;/strong> There are &lt;a href="https://pubmed.ncbi.nlm.nih.gov/29277291-adaptive-evolution-influences-the-infectious-dose-of-mers-cov-necessary-to-achieve-severe-respiratory-disease/" target="_blank" rel="noopener">reasons&lt;/a> &lt;a href="https://jamanetwork.com/journals/jama/fullarticle/2763136" target="_blank" rel="noopener">to&lt;/a> expect that the more particles  of virus a person is exposed to initially, the more likely they are  to experience severe disease. In the government’s approach there is no control over this and so it is possible that young and healthy people may develop severe symptoms due to exposure to a large viral load.&lt;/p>
&lt;p>&lt;strong>&lt;span style="text-decoration: underline;">An alternative approach&lt;/span>&lt;/strong>&lt;/p>
&lt;p>We have seen that the government actively intends for 60% of people to get the virus. It is almost as if it were to simply go and infect people, as at a &lt;a href="https://en.wikipedia.org/wiki/Pox_party" target="_blank" rel="noopener">chicken-pox party&lt;/a>.  So why not actually do this? Could there be advantages to actively exposing 60% of people in a controlled way to the virus to generate the same herd immunity?&lt;/p>
&lt;p>&lt;strong>&lt;span style="text-decoration: underline;">Advantag&lt;/span>&lt;/strong>&lt;span style="text-decoration: underline;">&lt;strong>es the controlled exposure approach&lt;/strong>&lt;/span>&lt;/p>
&lt;p>&lt;strong>Not infecting the vulnerable &lt;/strong> – only fit and healthy people would be selected to receive the virus. Almost no children under 10 have developed severe symptoms from COVID-19. It would therefore seem very safe to put all immunocompetent children into the 60% who get the virus. Other young people are also comparatively resilient to the virus, and so a utilitarian argument would suggest they would  be the safest people to inoculate with the virus. We will see below that this approach may be safer &lt;em>for the people  who get infected&lt;/em>, than the alternative policy of letting the virus pass through the population.&lt;/p>
&lt;p>&lt;strong>Not overloading the healthcare system &lt;/strong> – there are two ways in which this controlled approach would avoid overloading the healthcare system. Firstly, by avoiding exponential growth: those infected would know they had been infected and could be isolated afterwards until they were no longer shedding virus. Once resistant, they could go out into the population, and safely work in crucial roles where they were likely to be exposed to the virus. Secondly by reducing the hospitalisation rate: because these people would be drawn from a much more resilient population the chances of them developing severe symptoms would be much lower. The end result of this would be fewer people in hospitals, meaning that the small(er) number of people who did develop severe symptoms would be able to get adequate care. The end result might be that a 100% chance of being infected, and receiving adequate care if required, might be safer than a 60% chance of being infected with the possibility of developing severe symptoms in a degraded healthcare system, which is dealing with exponential growth and vulnerable patients.&lt;/p>
&lt;p>&lt;strong>Controlled viral load, and possibility of an attenuated strain&lt;/strong> – there are several lines of evidence to suggest that the amount of virus one is initially exposed to may be a determinant of whether someone develops severe symptoms. By controlling the infection one could minimise the amount of virus someone is exposed to (while ensuring they develop an immune response). This  might again substantially reduce the risk compared to a 60% chance of receiving a random viral load (determined by how near you are to an infected person and how much virus they are shedding). Finally, although proper “no-risk” vaccines are unlikely to be available for some time, my non-expert brain wonders whether it is possible to rapidly develop a version of the virus that would be expected to be mildly attenuated by, for example, leaving the proteins the virus is encoding exactly the same, but &lt;a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4508661/" target="_blank" rel="noopener">altering the “codons”&lt;/a> of DNA such that these proteins are likely to be produced less rapidly. The effectiveness of this could not be guaranteed, but on the balance of probabilities it seems very unlikely to be more dangerous than the wild-type virus.&lt;/p>
&lt;p>&lt;strong>&lt;span style="text-decoration: underline;">Summary&lt;/span>&lt;/strong>&lt;/p>
&lt;p>The government are conducting an experiment in which  they will allow 60% of people to be infected. To my mind this is in substance the same as the government randomly choosing 60% of people and actively infecting them with a random load of wild-type virus, but not telling them they are infected with the result that they may spread it to vulnerable people. An alternative approach in which selected resilient people were infected in a controlled manner with a low-dose of an attenuated virus might be safer &lt;em>for the people infected&lt;/em>, as well as society at large, than the current strategy.&lt;/p>
&lt;p>&lt;strong>&lt;span style="text-decoration: underline;">Disclaimer&lt;/span>&lt;/strong>&lt;/p>
&lt;p>I am neither a virologist, nor an immunologist, nor an epidemiologist. I would welcome explanations of where this argument falls down from such people, or anyone else. Furthermore, I am not arguing for this approach as superior to a containment strategy, merely as superior to a strategy of natural infection. Finally, this is a suggestion for an organised governmental approach, &lt;strong>not&lt;/strong> a DIY ‘chicken-pox party approach’ which would not control viral load and would therefore have great risk.&lt;/p></description></item><item><title>PubTweet</title><link>/blog/2019/01/25/pubtweet/</link><pubDate>Fri, 25 Jan 2019 03:43:22 +0000</pubDate><guid>/blog/2019/01/25/pubtweet/</guid><description>&lt;p>There are a lot of tweets to PubMed pages – not least from @MalariaPapers. I made &lt;a href="http://pubtweet.org/" target="_blank" rel="noopener">PubTweet&lt;/a> to enable these to have nice info-boxes, like this:&lt;/p>
&lt;blockquote class="twitter-tweet" data-lang="en">
&lt;p lang="en" dir="ltr">
Evaluation of automated malaria diagnosis using the Sysmex XN-30 analyser in a clinical setting. &lt;a href="https://t.co/ZA0vb59FzQ">https://t.co/ZA0vb59FzQ&lt;/a>
&lt;/p>
&lt;p>
&amp;mdash; Malaria Papers (@MalariaPapers) &lt;a href="https://twitter.com/MalariaPapers/status/1088393873339154433?ref_src=twsrc%5Etfw">January 24, 2019&lt;/a>
&lt;/p>
&lt;/blockquote></description></item><item><title>eMotion 5075 teardown</title><link>/blog/2019/01/05/emotion-5075-teardown/</link><pubDate>Sat, 05 Jan 2019 17:38:35 +0000</pubDate><guid>/blog/2019/01/05/emotion-5075-teardown/</guid><description>&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2019/01/epmotion.jpg" alt="">
In my PhD lab we had an epMotion 5075 pipetting robot. I had a like/hate relationship with this machine. Like: it’s an impressive, precision-engineered, piece of hardware. Hate: the software is appalling. Writing protocols for it was slow, frustrating and generally awful, and there was a general lack of flexibility in what one could make it do.&lt;/p>
&lt;p>Recently I heard that the lab was having a clear out, including disposing of this (pricey when purchased) robot and I asked if I could adopt it in preference to the scrapheap, which I was kindly allowed to. I’m not in a wet-lab at the moment so for now it will live in a garage, but I did want to have a peek inside to have a better understanding of how it works, and to work out whether it would be possible to customise it to be more flexible.&lt;/p>
&lt;p>If I were buying my own scientific hardware I would always go for the upstart companies like &lt;a href="http://opentrons.com/" target="_blank" rel="noopener">OpenTrons&lt;/a> and &lt;a href="https://incuvers.com/" target="_blank" rel="noopener">Incuvers&lt;/a> which tell you how their hardware works and allow you to do whatever you want with it. With the epMotion, by contrast, if you want to use new labware you have to send a physical version of it to the company which they measure to generate a proprietary calibration file.&lt;/p>
&lt;p>I was given some hope that it might be possible to customise the robot from this video, in which someone has replaced all the electronics of the robot with a standard board for a CNC machine:&lt;/p>
&lt;p>&lt;iframe src="https://www.youtube.com/embed/IDlZ_FIUgjM" width="560" height="315" frameborder="0" allowfullscreen="allowfullscreen">&lt;/iframe>&lt;/p>
&lt;p>But other than that I could find very little on the internet about what is inside these robots. I think that’s a shame, and now I have one at my disposal, without a warranty. So here is a run-down of what happens when you take it apart, in case it is useful to anyone in a similar position.&lt;/p>
&lt;p>&lt;strong>First steps&lt;/strong>&lt;/p>
&lt;p>The back panels come off very easily with a hex-key and expose the computer that runs the machine. This runs some version of Windows, maybe Windows CE. It has USB and ethernet ports although to my knowledge with my version of this robot these can’t be used for anything useful. In general I doubt there is any easy way to make this computer do anything other than what Eppendorf has programmed it to do, without access to the underlying source code.&lt;/p>
&lt;p>Removing the top required in my case removing a little bit of double sided tape at either side, in addition to two hex-key bolts.&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2019/01/epmotionteardown1.jpg" alt="">&lt;/p>
&lt;p>There is a heavy-duty belt for the X axis with a big stepper motor.  My robot had been essentially unused for several years and the rail over which the X-carriage runs had become covered with a sticky substance. This caused the motors to stall mid-run, but cleaning them off with some alcohol resolved this issue.&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2019/01/P1010610-1200x1600.jpg" alt="">&lt;/p>
&lt;figcaption id="caption-attachment-321" class="wp-caption-text">The computer that is the brains of the operation &amp;#8211; unfortunately unlikely to be easily repurposable.&lt;/figcaption>&lt;/figure>
&lt;p>&lt;strong>Basics&lt;/strong>&lt;/p>
&lt;p>Each of the X, Y and Z axes is controlled by a stepper motor (the X-axis one is &lt;a href="https://catalog.orientalmotor.com/item/all-categories/tegories-pk-series-2-phase-stepping-motors-legacy-/pk266-03a" target="_blank" rel="noopener">this&lt;/a>). They each have optical endstops with 4 wires. In the video above these endstops have been replaced with mechanical switches but it really should be possible to use them as-is.&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2019/01/P1010626-e1546707506491-1200x1600.jpg" alt="">&lt;/p>
&lt;figcaption id="caption-attachment-322" class="wp-caption-text">X-belt and optical end-stop&lt;/figcaption>&lt;/figure>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2019/01/P1010690-1200x900.jpg" alt="">&lt;/p>
&lt;figcaption id="caption-attachment-317" class="wp-caption-text">Y-axis stepper motor, belt, and optical end-stop.&lt;/figcaption>&lt;/figure>
&lt;p>&lt;strong>Cabling&lt;/strong>&lt;/p>
&lt;p>One of the challenges of making a many-axis robot is that signals have to be carried to each successive axis, all of which are connected together. So flexible cabling is needed -but at the same time it has to not get in the way or fall into the samples. In the case of the epMotion this is carried out with ribbon cables like this:&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2019/01/ribboncable-1200x900.jpg" alt="">&lt;/p>
&lt;p>But it quickly becomes apparent that this cable doesn’t have enough wires to be simply directly connected at the other end to stepper motors / endstops / etc. Instead it seems that this is some sort of serial cable that carries data signals to a series of other microprocessors, one on the robot’s pipetting arm, and one for each of the Y and Z axes, which then interface with the Y motor, Z motor, the tool locking motor, the pipetting motor, the tip-ejecting actuator, and the range-detector.&lt;/p>
&lt;p>If you want to hack this thing you’ll have to decide whether you want to have to make and mount 4 separate pieces of control hardware, or to replace the cabling with a much thicker set of wires.&lt;/p>
&lt;p>&lt;strong>Pipetting arm&lt;/strong>&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2019/01/pipettearm2-1200x872.jpg" alt="">&lt;/p>
&lt;p>Lurking under the metal cover of the tool arm is a profusion of electronics. There’s a lot to do. An (infrared?) sensor to measure distance, and actuation of grabbing a tool, identifying it, pipetting up and down, and ejecting a tip.&lt;/p>
&lt;p>&lt;strong>Selecting/using tools&lt;/strong>&lt;/p>
&lt;p>One of the very impressive things about the epMotion robot is its ability to change tools during operation. It can choose from a variety of single channel and multichannel pipettes, and even a plate gripper.&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2019/01/P1010677-1200x900.jpg" alt="">&lt;/p>
&lt;figcaption id="caption-attachment-326" class="wp-caption-text">Tools&lt;/figcaption>
&lt;p>How does this process work?&lt;/p>
&lt;p>The tool arm has two coaxial motors. One is, I believe, a simple DC motor with a very low gearing. It rotates a bit of metal internal to the arm which causes it to firmly grip whichever tool it is currently over. I’m not quite sure how the robot knows when this rotation is finished. My suspicion is that it detects the change in current flowing through the motor when the motor stalls at the end. Certainly if you disconnect this motor, the robot is able to detect that ‘the engine is not responding’, and informs you so.&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2019/01/insidetoolarm-1200x900.jpg" alt="">&lt;/p>
&lt;figcaption id="caption-attachment-325" class="wp-caption-text">Looking up at the inside of the tool gripper to see how it works.&lt;/figcaption>
&lt;p>When one examines the pipettes themselves one notices they have electrical contacts, but these are simply used to tell the robot which tool is in what place. The pipettes are in fact mechanical rather than electronic devices. They all have the same rotatable top-piece, and as this is spun by a stepper motor in the tool arm they aspirate/dispense liquid (or in the case of the gripper, grab and release). As this piece is rotated the tool begins to extend a rod out from it. Inside the tool-gripper this rod must make contact with a switch, and this is used to “home” the pipette to ensure the robot knows the position of the plunger.&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2019/01/P1010651-1200x900.jpg" alt="">&lt;/p>
&lt;figcaption id="caption-attachment-327" class="wp-caption-text">Homed tool with thin rod extended to make contact with switch. Electrical contacts for tool ID visible to the right.&lt;/figcaption>&lt;/figure>
&lt;p>&lt;strong>Prospects for customisation&lt;/strong>&lt;/p>
&lt;p>I’m going to pause my hardware work here, because it isn’t yet clear exactly what the application of the robot will be for me and I don’t want to destroy any necessary functionality.&lt;/p>
&lt;p>If I had continued I would have one way or another tried to marry up the epMotion hardware with the open-source &lt;a href="https://github.com/Opentrons" target="_blank" rel="noopener">OpenTrons robot-control software&lt;/a>. This basically means adapting the hardware such that one knows how to control it and then writing a custom driver for the OpenTrons software.&lt;/p>
&lt;p>I do think this is completely achievable. The video above already shows how 3-axis control is possible, using a standard CNC board. Controlling aspirate/dispense as a fourth axis should be similarly simple. If my understanding of how the tool interlock works is correct than that also wouldn’t be too challenging – one would just need to measure the current flowing through the motor. An even simpler strategy would just be to keep one tool locked onto the machine.&lt;/p>
&lt;p>One decision one would have to make would be whether to have a single control board and have lots and lots of wires running to the tool-arm, or to use the existing ribbon cables and have a separate controller on the tool arm controlled over serial. I suspect the latter might be the better approach.&lt;/p>
&lt;p>More generally, if I do this I will have to consider whether I want to be limited to expensive epMotion robot tips, the only ones compatible with any of these tools. I suspect the answer is no. In that case I might end up bolting an &lt;a href="http://opentrons.com/pipettes" target="_blank" rel="noopener">OT-2 electronic pipette&lt;/a> to the pipetting arm, though this again loses the advantages of tool-changing. Or maybe I’ll go with something completely different like a vacuum pump and a peristaltic pump – we’ll see.&lt;/p>
&lt;p>In general none of this looks trivial, and one is almost certainly better off just buying an inexpensive &lt;a href="http://opentrons.com/ot-2" target="_blank" rel="noopener">OT2&lt;/a>. Still, it’s nice to have a better understanding of what is going on inside this intricately engineered machine.&lt;/p>
&lt;p> &lt;/p>
&lt;p>&lt;strong>Update:&lt;/strong>&lt;/p>
&lt;p>It has just occurred to me (another useful reason for writing things down) that there may be an easier and less invasive way to get control of this thing. If one can reverse engineer the serial control that the computer uses to control the Y-axis, Z-axis, tool interlock, aspiration tip ejection (and distance measuring) then one can get control of all of these without messing with their hardware. It seems possible that this could be achieved relatively simply (if they are sent in a text-based format) and when I have access to the machine again in 6 months time I will investigate. The 8 leads in the ribbon cable &lt;em>could&lt;/em> be: V+, GND, Y-out, Y-in, Z-out, Z-in, pipette-out, pipette-in.&lt;/p></description></item><item><title>BigGAN interpolations</title><link>/blog/2018/11/13/biggan-interpolations/</link><pubDate>Tue, 13 Nov 2018 14:51:57 +0000</pubDate><guid>/blog/2018/11/13/biggan-interpolations/</guid><description>&lt;p>The state of the art in image generation is &lt;a href="https://arxiv.org/abs/1809.11096" target="_blank" rel="noopener">BigGAN&lt;/a>.&lt;/p>
&lt;p>Now, some &lt;a href="https://colab.research.google.com/github/tensorflow/hub/blob/master/examples/colab/biggan_generation_with_tf_hub.ipynb" target="_blank" rel="noopener">trained models&lt;/a> have been made available, including the capacity to interpolate between classes. I made &lt;a href="https://colab.research.google.com/drive/1MhfEAOBwhGu1A-F2NSVxGQrkJ4vk7w4V#scrollTo=dSAyfDfnVugs&amp;amp;forceEdit=true&amp;amp;offline=true&amp;amp;sandboxMode=true" target="_blank" rel="noopener">a colab&lt;/a> to easily create animations from these.&lt;/p>
&lt;p>They are pretty fun.&lt;/p>
&lt;p>&lt;img class="aligncenter size-full wp-image-263" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/11/cat.gif" alt="" width="256" height="256" />&lt;/p>
&lt;p>What is more, they make it clear that the latent space clearly captures very meaningful shared properties across classes. The poses of quite different animals are conserved, and “cat eyes” clearly map onto “dog eyes” during interpolation. These sort of properties suggest that the network ‘understands’ the scene it is generating.&lt;/p>
&lt;p>Here are some more:&lt;/p>
&lt;p>&lt;img class="aligncenter size-full wp-image-278" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/11/cattohusky.gif" alt="" width="256" height="256" />&lt;/p>
&lt;p>&lt;img class="aligncenter size-full wp-image-280" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/11/leopard.gif" alt="" width="256" height="256" />&lt;/p>
&lt;p>&lt;img class="aligncenter size-large wp-image-264" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/11/goose2.gif" alt="" width="256" height="256" />&lt;/p>
&lt;p>&lt;img class="aligncenter size-large wp-image-267" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/11/dog.gif" alt="" width="256" height="256" />&lt;/p>
&lt;p>&lt;img class="aligncenter" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/11/panda2.gif" alt="" />&lt;/p>
&lt;p>&lt;img class="aligncenter size-large wp-image-267" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/11/tiger.gif" alt="" />&lt;/p>
&lt;p>(this one moves in latent space as well as class space, hence the change of pose:)&lt;br>
&lt;img class="aligncenter size-large wp-image-267" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/11/bulldog.gif" alt="" />&lt;br>
Churches to mosques:&lt;/p>
&lt;center>
&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/11/mosque2.gif" alt="" width="256" height="256" /> &lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/11/mosque.gif" alt="" width="256" height="256" />
&lt;/center>
&lt;center>
&lt;/center>
&lt;center>
&lt;/center>
&lt;center>
&lt;/center></description></item><item><title>Adventures with InfoGANs: towards generative models of biological images (part 2)</title><link>/blog/2018/10/02/adventures-with-infogans-towards-generative-models-of-biological-images-part-2/</link><pubDate>Tue, 02 Oct 2018 10:05:06 +0000</pubDate><guid>/blog/2018/10/02/adventures-with-infogans-towards-generative-models-of-biological-images-part-2/</guid><description>&lt;p>In &lt;a href="http://theo.io/blog/2018/10/02/adventures-with-infogans-towards-generative-models-of-biological-images/" target="_blank" rel="noopener">the last post&lt;/a> I introduced neural networks, generative adversarial networks (GANs) and InfoGANs.&lt;/p>
&lt;p>In this post I’ll describe the motivation and strategy for creating a GAN which generates images of biological cells, like this:&lt;/p>
&lt;p>&lt;strong>Motivation&lt;/strong>&lt;br>
Two microscopic of cells from an identical cell-line are never going to be pixel-for-pixel identical, yet they still share key similarities in terms of morphology. One way to get a computer to demonstrate it “understands” these morphological properties is to force it to create images of new cells. When a model is capable of generating any image that might be taken of a specific cell one might argue that it has gained some knowledge about the cell.&lt;/p>
&lt;p>This is an appealing approach as it is is easy to acquire large numbers of static images of cells, for instance by using an imaging flow cytometer. This device flows cells past a camera and acquires thousands of images each second, each with a large number of fluorescent channels. These are static images of course, but if they come from an synchronous population they should contain representatives of every stage in the cell cycle. If our generative model was sufficiently capable of truly understanding the structure in the data (and there is &lt;a href="https://twitter.com/ericjang11/status/1046124500369047553" target="_blank" rel="noopener">evidence that such models do&lt;/a>) then provided if we could generate a model where one dimension in our generator corresponded to pseudotime we could generate timecourse “videos” from models trained on these single images. This would, apart from anything else, have practical utility, avoiding the problems of photobleaching in imaging.&lt;/p>
&lt;p>&lt;strong>What I did&lt;/strong>&lt;/p>
&lt;p>From my work at the &lt;a href="https://www.sanger.ac.uk/science/groups/rayner-group" target="_blank" rel="noopener">Rayner lab&lt;/a> at the Sanger Institute I have access to a large dataset of images of infected red blood cells acquired with an imaging flow cytometer. These images contain both a brightfield transmitted light channel and a fluorescent channel showing DNA in the parasite. I used some filtering (with a classification network) to isolate only images containing single cells which were fully visible. I then trained an InfoGAN in much the same way as in the digit dataset described in the last post.&lt;/p>
&lt;p>I tried a couple of different versions, one with a large number of “communicated” values – which is what you see above.&lt;/p>
&lt;p>The network learns about quite a few aspects of &lt;em>Plasmodium&lt;/em>&lt;br>
biology, and also some basic optics:&lt;/p>
&lt;ul>
&lt;li>It learns about red blood cell morphology and to produce images of plausible cells&lt;/li>
&lt;li>It learns that the nucleus in the DAPI channel is always within the bounds of the RBC in the brightfield channel.&lt;/li>
&lt;li>It learns that there are a subset of cells (schizonts) which have both black haemozoin, and widespread, bright DAPI nuclei (often arranged in a circular shape)&lt;/li>
&lt;li>It learns that cells can appear in front of or behind the focal plane and how to render both types.&lt;/li>
&lt;li>I could go on.. the images produced by the network are almost all entirely plausible images that a biologist would be unable to distinguish from true parasites.&lt;/li>
&lt;/ul>
&lt;p>As an aside I really like watching this network cycle between samples, it is strikingly similar to watching a motile cell wriggling:&lt;br>
&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/09/cell_gan.gif" alt="" width="480" height="160" class="alignnone size-full wp-image-215" />&lt;/p>
&lt;p>I also trained a &lt;a href="http://theo.io/GAN/plasmodium_gan2/test.html" target="_blank" rel="noopener">second version&lt;/a>, with many fewer communicated variables, which really lets us see what the network sees as the most salient features. Unsurprisingly, these are mostly about the location and orientation of the red blood cell. Interestingly this network makes one of the parameters the focal position of the cell:&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/09/focus.gif" alt="" width="480" height="232" class="alignnone size-full wp-image-216" />&lt;/p>
&lt;p>For any cell you look at, one end of this variable produces one type of halo, and the other the opposite, just as if this parameter was controlling the focus of a microscope.&lt;/p>
&lt;p>This property illustrates the sort of property it would be really exciting to get the network to learn. In an ideal world the sliders would represent something like: focus, cell orientation and parasite lifecycle stage. So if you had a young ring stage parasite and you wanted to watch it mature you could just drag the slider across. Or if you wanted to focus on the far side of the cell you could just drag another slider. Such an idea may sound fanciful, but I don’t think it’s too far away.&lt;/p>
&lt;p>There are a number of simple ways I could improve the work I’ve done here. The network has to capture the complete distribution of cellular images presented as “real”. In this case you can see that these are in many different orientations, and different positions in the image. So a vast amount of the networks efoort goes into recapturing that, not very interesting, spatial variation. I made some basic attempts to align the images presented to the network, but this is something I could definitely improve. Something you will see as the cells dance from one space in the network to another is that while the nucleus tends to move smoothly around the black haemozoin will often fade out in one location and appear in another. The lack of smoothness here is an example of “modal collapse” that often haunts GANs, but there are a number of ways to tackle it.&lt;/p>
&lt;p>In short, this work just scratches the surface of what what I suspect is possible with generative models of biological cells.&lt;/p>
&lt;p>In some organisms there are genome-wide fluorescent-tag libraries available. Building a generative model using these (possibly with the need for some pairwise imaging) could allow the creation of a synthetic cell in which every protein can be simultaneously visualised. It’s an exciting prospect, and I think it’s nearer than it seems.&lt;/p>
&lt;p>&lt;small>P.S. I belatedly looked for similar published work, and found two &lt;a href="https://www.biorxiv.org/content/early/2017/12/02/227645">cool&lt;/a> &lt;a href="https://arxiv.org/pdf/1708.04692.pdf">papers&lt;/a>. The second of these introduces a star-shaped network designed to allow alignment in much the way I imagine at the end of this post. And more generally there are a ton of GAN papers applying the technique to super-resolution microscopy, in silico staining, etc.&lt;/small>&lt;/p></description></item><item><title>Adventures with InfoGANs: towards generative models of biological images (part 1)</title><link>/blog/2018/10/02/adventures-with-infogans-towards-generative-models-of-biological-images/</link><pubDate>Tue, 02 Oct 2018 09:00:46 +0000</pubDate><guid>/blog/2018/10/02/adventures-with-infogans-towards-generative-models-of-biological-images/</guid><description>&lt;p>I recently began an &lt;a href="https://ai.google/research/join-us/ai-residency/" target="_blank" rel="noopener">AI Residency&lt;/a> at Google, which I am enjoying a great deal. I have been experimenting with deep-learning approaches for a few years now, but am excited to immerse myself in this world over the coming year. Biology increasingly generates very large datasets and I am convinced that novel machine-learning approaches will be essential to make the most of them.&lt;/p>
&lt;p>At the beginning of my residency, I was advised to complete a &lt;em>mini-project&lt;/em> which largely reimplements existing work, as an introduction to new tools.  In this post I’m going to describe what I got up to during that first few weeks, which culminated in the tool below that conjures up new images of red blood cells infected with malaria parasites:&lt;/p>
&lt;p>&lt;script>
function resizeIframe(obj) {
obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';
}
&lt;/script>&lt;br />
&lt;iframe src="http://static.theo.io/GAN/plasmodium_gan/test.html" style="width:100%; height:500px" frameborder="0" scrolling="no" onload="resizeIframe(this)" >&lt;/iframe>&lt;/p>
&lt;p>I’m going to try to explain it from first principles, which might take a while, so if you have a background in machine-learning, &lt;a href="http://theo.io/blog/2018/10/02/adventures-with-infogans-towards-generative-models-of-biological-images-part-2/" target="_blank" rel="noopener">skip to the next post&lt;/a>.&lt;/p>
&lt;p>&lt;strong>Neural net-what?&lt;/strong>&lt;/p>
&lt;p>Deep learning is based around things called neural networks. A neural network takes a series of numbers in, does some processing to them, and ultimately spits out another set of numbers. A system like this is in theory capable of undertaking a great many tasks: for example the first series of numbers could be the brightness values for each pixel in an image, and the number outputted could be the probability that the image contains a cat. If the network can map those sets of numbers to each other successfully, then you have a cat-recognition network.&lt;/p>
&lt;figure id="attachment_221" aria-describedby="caption-attachment-221" style="width: 833px" class="wp-caption aligncenter">&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/09/cat-01.png" alt="" width="833" height="342" class="size-full wp-image-221" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2018/09/cat-01.png 833w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/09/cat-01-300x123.png 300w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/09/cat-01-768x315.png 768w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px" />&lt;figcaption id="caption-attachment-221" class="wp-caption-text">A hypothetical classification network to detect images of cats&lt;/figcaption>&lt;/figure>
&lt;p>But what determines whether the network will recognise cats,  koalas, or fail to recognise anything at all? Each network contains a vast array of &lt;em>parameters&lt;/em>, which determine how the input numbers are processed to produce the output. These are knobs which can be twiddled to make the network do different things.&lt;/p>
&lt;p>The magic that makes neural networks powerful is a process called &lt;em>back-propagation&lt;/em>, which allows the system to automatically twiddle these knobs until the network produces the desired output for each input. This requires a large amount of labelled data. For our cat network we might give it 1,000 photos of cats, and 1,000 photos of dogs. The system will start off by setting the parameters to random values. It will then feed in the first cat photo and see what number it gets out. With these random values, the network will most likely output 0.5 as the cat probability, even though the true value is 1 (it’s a cat!). But with back-propagation the system can observe this error (0.5 – 1 = -0.5) and calculate which direction it needs to turn each knob (and by how much) to make the error smaller. If we repeat this process over and over and over again (which is called &lt;em>training&lt;/em>), we will eventually we find we have a network that can reliably distinguish cats and dogs. And it turns out that the graphics cards in our computers can be commandeered to make that process happen pretty quickly. In an hour or so we can have our cat recognition network – jubilations.&lt;/p>
&lt;p>With those basic principles one can build a network to do any sort of classification problem. If you have searched your own photos based on what they contain  (e.g. on Google photos) then you have interacted with just such a network.&lt;/p>
&lt;p>&lt;strong>Making computers creative&lt;/strong>&lt;/p>
&lt;p>You might think at this point that our network has a pretty good idea what a cat looks like, but unfortunately with this approach you can’t ask it to draw one.&lt;/p>
&lt;p>One &lt;em>can&lt;/em> imagine a neural network which could draw, however: this time the &lt;em>output&lt;/em> would be a series of numbers, which we will convert into to the brightness values of pixels in an image. What should the input be? It turns out we can just use random numbers:  for each image we can sample say 10 values from a normal distribution, and feed them in. That way, in theory, the network can draw on this randomness to generate a different picture each time, and act as an image &lt;em>generator&lt;/em>.&lt;/p>
&lt;p>There is a problem of course. The network still has no idea what cats look like. When it is created, with its knobs set to random positions, it will generate images that resemble those on an un-tuned TV. In theory we could train it ourselves, by letting it know whenever it produced noise that had the faintest of resemblance to a cat, until it was coaxed into doing what we wanted. In practice however, this would take an eternity.&lt;/p>
&lt;p>So what to do? Well, there’s a trick, &lt;a href="https://arxiv.org/abs/1406.2661" target="_blank" rel="noopener">invented&lt;/a> just four years ago, which has been revolutionary. We can introduce a second network, called a &lt;em>discriminator&lt;/em>. This is a classification network, like the one we imagined above. But this time its task is not to distinguish cats from dogs, but to distinguish real photos of actual cats, from fake cats imagined by the generator. We feed it some real cats, and some fake ‘cats’ that the generator has produced, and we train it. Initially it has a very easy job here, since remember the generator is just displaying the images of an untuned TV. But wait..&lt;/p>
&lt;p>Once the discriminator starts to do a decent job we can take our &lt;em>back-propagation&lt;/em> one step further. The system can backpropagate from the final result (“fake” or “real”) back to the pixel values produced by the generator, and then all the way back through the generator to the random variables that made these fake images. Then it can ask &lt;em>“what directions should I turn the knobs of the generator so that it produces an output that the discriminator thinks is real?”&lt;/em>. In this way, the generator can be trained to fool the discriminator, and in doing so, the images it produces will become a bit more cat-like.&lt;/p>
&lt;p>The discriminator can now be trained again, to be more expert in telling these synthetic cats from their real counterparts. In fact we bounce back and forth, training generator and then discriminator in a continual loop. They have opposing goals, the generator wants to make realistic cat images and the discriminator wants to tell these apart from &lt;em>true&lt;/em> cat images, and so this architecture is called a &lt;em>generative adversarial network&lt;/em> or GAN. After a long period of training these networks can produce  results like these:&lt;/p>
&lt;figure id="attachment_180" aria-describedby="caption-attachment-180" style="width: 288px" class="wp-caption alignnone">&lt;img class=" wp-image-180" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/08/Screenshot-from-2018-08-27-21-19-48.png" alt="" width="288" height="293" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2018/08/Screenshot-from-2018-08-27-21-19-48.png 663w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/08/Screenshot-from-2018-08-27-21-19-48-296x300.png 296w" sizes="(max-width: 288px) 85vw, 288px" />&lt;figcaption id="caption-attachment-180" class="wp-caption-text">Results of a cat GAN. (This figure comes from a [paper][4] by Alexia Jolicoeur-Martinea about a novel type of discriminator)&lt;/figcaption>&lt;/figure>
&lt;figure id="attachment_179" aria-describedby="caption-attachment-179" style="width: 512px" class="wp-caption alignnone">&lt;img class="wp-image-179 size-full" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/08/representative_image_512x256.png" alt="" width="512" height="256" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2018/08/representative_image_512x256.png 512w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/08/representative_image_512x256-300x150.png 300w" sizes="(max-width: 512px) 85vw, 512px" />&lt;figcaption id="caption-attachment-179" class="wp-caption-text">And with some extensions of the GAN approach [Nvidia][5] were able to hallucinate these wholly imaginary celebrities.&lt;/figcaption>&lt;/figure>
&lt;p>Not bad, eh?&lt;/p>
&lt;p>&lt;strong>InfoGAN – images that communicate information&lt;/strong>&lt;/p>
&lt;p>This approach can produce realistic images. But the relationship between the random noise at the beginning and the image at the end is not generally clear. If we increase value 3 by 50% what will happen? It is generally difficult to predict, and does not correspond in a useful way to a semantically meaningful property of the image.&lt;/p>
&lt;p>There would be a lot of value to a network which, without being specifically trained to, could actually understand the structure in these images (e.g. that there are different breeds of cat) and that at the end could generate an image of any breed of your choice.&lt;/p>
&lt;p>Some people came up with a very clever way of doing this, called an InfoGAN. This approach is very similar to the original GAN. The generator still draws on random noise to produce its image. However the generator is also given some &lt;em>extra noise&lt;/em>, which it is tasked with encoding into the image it produces. For instance in the original InfoGAN paper the researchers produced a network which made images of hand-written digits. The extra noise they added was a discrete ‘one-hot’ variable with ten possible values. The idea was to create a network where each of these values corresponded to a different digit. To get this to happen they created an additional training objective for both the generator and the discriminator. As before, the discriminator still wants to distinguish real images from fake images and the generator still wants to fool the discriminator. However &lt;em>both the discriminator and the generator&lt;/em> are also rewarded if the discriminator is able to successfully reconstruct the extra random variable that was fed to the generator.&lt;/p>
&lt;p>This means the generator now has to encode &lt;em>information&lt;/em> (a variable with ten possible values) into an image, but that image has to be a plausible member of the set of hand-written digit images. The strategy that it ends up taking is to encode each value as a separate digit, and tada, we have achieved our goal. We can now ask the network to generate any specific digit we like. We can choose threes and generate an infinite number of different threes in different styles. The researchers also showed that if they added two more continuous variables to be communicated, these ended up mapped to the angle, and the width, of the digit produced.&lt;/p>
&lt;p> &lt;/p>
&lt;figure id="attachment_190" aria-describedby="caption-attachment-190" style="width: 639px" class="wp-caption alignnone">&lt;img class="wp-image-190 size-full" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/09/1_kyyjNnuNaOscjucBpql2AA.png" alt="" width="639" height="390" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2018/09/1_kyyjNnuNaOscjucBpql2AA.png 639w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/09/1_kyyjNnuNaOscjucBpql2AA-300x183.png 300w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px" />&lt;figcaption id="caption-attachment-190" class="wp-caption-text">Figure from the InfoGAN paper showing the three properties the network has learnt (digit type, angle and width)&lt;/figcaption>&lt;/figure>
&lt;p>I began by reimplementing some of what these researchers had achieved, focusing on this hand-written digit task. Here are the images my network produced evolving over time:&lt;/p>
&lt;p>&lt;img src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/09/image3.gif" alt="" width="140" height="168" class="aligncenter size-full wp-image-223" />&lt;/p>
&lt;p>You can see the network gradually deciding how it will encode each value. It is undecided about what should be a five and what should be a zero for a long time, but it eventually comes to a conclusion. So without labelling any of the data, the system has learnt to partition it into ten appropriate categories, and has built a system for arbitrarily generation members of each of these categories.&lt;/p>
&lt;p>There are a near-infinite number of possible threes that can be drawn – cleaner or curlier, thicker or thinner, but all are united in being threes. I think that a very similar property applies in biological cells and in the &lt;a href="http://theo.io/blog/2018/10/02/adventures-with-infogans-towards-generative-models-of-biological-images-part-2/" target="_blank" rel="noopener">next post&lt;/a> I’ll describe my forays into this area, and the promise I think such an approach holds.&lt;/p>
&lt;p>&lt;a href="http://theo.io/blog/2018/10/02/adventures-with-infogans-towards-generative-models-of-biological-images-part-2/" target="_blank" rel="noopener">&amp;raquo;&amp;raquo; Part 2&lt;/a>&lt;/p></description></item><item><title>How I stumbled upon a novel genome for a malaria-like parasite of primates</title><link>/blog/2018/04/23/how-i-stumbled-upon-a-novel-genome-for-a-malaria-like-parasite-of-apes/</link><pubDate>Mon, 23 Apr 2018 17:39:10 +0000</pubDate><guid>/blog/2018/04/23/how-i-stumbled-upon-a-novel-genome-for-a-malaria-like-parasite-of-apes/</guid><description>&lt;p>&lt;span style="color: gray;">Sometimes in science you come across things that are definitely interesting, and useful, but which you don’t have time to write up properly for one reason or another. I’m going to try to get into the habit of sharing these as blog-posts rather than letting them disappear. Here is one such story.&lt;/span>&lt;/p>
&lt;hr>
&lt;p>Not long ago I was searching for orthologs of a malaria gene of interest on the NCBI non-redundant database, which allows one to search across the entire (sequenced) tree of life. Here is a recreation of what I saw:&lt;/p>
&lt;p>&lt;img class="alignnone size-full wp-image-121" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.27.51.png" alt="" width="780" height="236" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.27.51.png 780w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.27.51-300x91.png 300w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.27.51-768x232.png 768w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px" />&lt;/p>
&lt;p>I was surprised to see that nestled among the &lt;em>Plasmodium&lt;/em> species was a sequence from a species called &lt;em>Piliocolobus tephrosceles&lt;/em>.&lt;/p>
&lt;p>A web search revealed this to be the linnaean name for the &lt;a href="https://en.wikipedia.org/wiki/Ugandan_red_colobus" target="_blank" rel="noopener">Ugandan red colobus&lt;/a> monkey. Odd that this monkey should have a gene so similar to one from a parasite, eh? But there are some weird misannotations on NCBI. However a bit later I saw the same thing happen again with another gene, and thought something must be going on. I tried more malaria genes and found I could almost always find a strong match in the colobus assembly.&lt;/p>
&lt;p>I navigated through NCBI to find some more about this particular monkey.&lt;/p>
&lt;p>&lt;img class="alignnone size-full wp-image-122" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.33.54.png" alt="" width="504" height="302" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.33.54.png 504w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.33.54-300x180.png 300w" sizes="(max-width: 504px) 85vw, 504px" />&lt;/p>
&lt;p>&lt;a href="https://www.ncbi.nlm.nih.gov/biosample/SAMN07735529/" target="_blank" rel="noopener">The page&lt;/a> tells us that this monkey from which this genome was sequenced was found here, in the depths of Kibale National Park (it was sequenced for a &lt;a href="http://molecular-anthro.uoregon.edu/index.html" target="_blank" rel="noopener">University of Oregon&lt;/a> genome study, &lt;a href="https://twitter.com/MolecAnth/status/942838967342264320" target="_blank" rel="noopener">in prep.&lt;/a>):&lt;/p>
&lt;p>&lt;img class="alignnone size-full wp-image-123" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.37.08.png" alt="" width="380" height="266" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.37.08.png 380w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.37.08-300x210.png 300w" sizes="(max-width: 380px) 85vw, 380px" />&lt;/p>
&lt;p>It also tells us that the sequence came from whole blood. This methodology seemed to be consistent with researchers serendipitously acquiring sequence from a blood-borne parasite in the process of sequencing the monkey genome.&lt;/p>
&lt;p>Just how much of this genome is there in the colobus sample? I downloaded the assembly to find out. The assembly was broken up into 47,644 contigs. My hypothesis was that some of these represented monkey sequence and others represented this sequence of a malaria-like parasite. I calculated the GC content of each contig and plotted a distribution:&lt;/p>
&lt;p>&lt;img class="alignnone size-full wp-image-124" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.55.22.png" alt="" width="398" height="298" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.55.22.png 398w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-21.55.22-300x225.png 300w" sizes="(max-width: 398px) 85vw, 398px" />&lt;/p>
&lt;p>&lt;em>Plasmodium spp.&lt;/em> have a much lower GC-content than mammalian species, and from this it looks like whatever species we have here shows this same bias. Just to be sure I also searched each “colobus” contig with Diamond (a faster Blast-like tool) against all protein sequences of the rhesus macaque and of &lt;em>P. vivax&lt;/em>. If a contig had a significantly higher score in &lt;em>P. vivax&lt;/em> than rhesus it was assigned to that species and vice versa. Overlaying this data was pretty compelling:&lt;/p>
&lt;p>&lt;img class="alignnone size-full wp-image-125" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-22.07.52.png" alt="" width="754" height="317" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-22.07.52.png 754w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/04/Screen-Shot-2018-04-22-at-22.07.52-300x126.png 300w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px" />&lt;/p>
&lt;p>I decided that by taking contigs which were either significantly better matches to &lt;em>P. vivax&lt;/em>, or alternatively had a GC content below 24%, I would get a genome which was almost entirely this intriguing species. This gave me 13,460 contigs representing about 30 Mbp of sequence (&lt;em>Plasmodium&lt;/em> genomes are 20-30 Mbp so this could potentially be a genome’s worth – although I don’t always get BLAST matches, so I suspect it is somewhat less). I also got in touch with the person named in the NCBI accession to see if they were already investigating these:&lt;/p>
&lt;blockquote class="twitter-tweet" data-lang="en">
&lt;p dir="ltr" lang="en">
hey &lt;a href="https://twitter.com/theosanderson?ref_src=twsrc%5Etfw">@theosanderson&lt;/a> not specifically on the hepatocystis seqs in the assembly, though collaborators in our group have done some interesting work on hepatocystis in red colobus themselves &lt;a href="https://t.co/yLs6ycTYrv">https://t.co/yLs6ycTYrv&lt;/a>
&lt;/p>
&lt;p>
— Noah Simons (@noahdsimons) &lt;a href="https://twitter.com/noahdsimons/status/981977413314736128?ref_src=twsrc%5Etfw">April 5, 2018&lt;/a>
&lt;/p>
&lt;/blockquote>
&lt;p>My home institute has released a rather neat web tool called &lt;a href="https://companion.sanger.ac.uk/" target="_blank" rel="noopener">Companion&lt;/a>, which allows you to upload a series of genomic contigs and have them annotated with reference to a known genome using a whole pipeline of analysis. (Unfortunately it only accepts up to 3,000 sequences. But you can download it as a Docker container to circumvent that restriction).&lt;/p>
&lt;p>&lt;a href="https://companion.sanger.ac.uk/jobs/dcf60d31de2b43c841a62928" target="_blank" rel="noopener">Here&lt;/a> are the results from its run on these sequences. Companion identifies &amp;gt;2000 genes, including such favourites as circumsporozoite protein, GAP50, PTEX88 and the SERAs. It nicely annotates a pseudochromosome-based version of the genome (although I’m not sure it’s taking full advantage of the synteny at the moment).&lt;/p>
&lt;p>So what is this mysterious species?&lt;/p>
&lt;p>It clearly isn’t an already sequenced &lt;em>Plasmodium&lt;/em> species. A bit of googling suggested to me that it might be some species of &lt;em>Hepatocystis&lt;/em>, which are &lt;a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3676718/" target="_blank" rel="noopener">known to infect red Colobus&lt;/a>. Hepatocystis seems in some ways to be an unnecessary genus, since the latest phylogenies show that evolutionarily it lies nested within &lt;em>Plasmodium,&lt;/em> being more closely related to mammalian &lt;em>Plasmodium&lt;/em> species than is the avian malaria parasite &lt;em>Plasmodium gallinaceum&lt;/em>. But there are reportedly important differences of approach between the groups – hepatocystis seems to lack the asexual cycle, with replication occurring only in the liver. One might hypothesise that this would lead to substantial loss of intra-erythrocytic genes. Also these beasts are transmitted by midges rather than mosquitoes (that data the result of a &lt;a href="https://www.cabdirect.org/cabdirect/abstract/19522901249" target="_blank" rel="noopener">decade&lt;/a>–&lt;a href="https://www.ncbi.nlm.nih.gov/pubmed/13443413" target="_blank" rel="noopener">long&lt;/a> &lt;a href="https://www.ncbi.nlm.nih.gov/pubmed/13897017" target="_blank" rel="noopener">search&lt;/a>). There are no other genome-scale sequencing datasets available for hepatocystis.&lt;/p>
&lt;p>I searched GenBank for targeted hepatocystis sequences, and found a few, including the caseinolytic protease C gene which has been sequenced from numerous &lt;a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5537238/" target="_blank" rel="noopener">bat&lt;/a> &lt;a href="https://www.ncbi.nlm.nih.gov/pubmed/18248741" target="_blank" rel="noopener">isolates&lt;/a>. I found the matching sequences for these in the Colobus assembly and then Blasted those sequences back against GenBank to recover a set of sequences to analyse. Constructing a tree with &lt;a href="http://www.phylogeny.fr/" target="_blank" rel="noopener">Phylogeny.fr&lt;/a> seemed to demonstrate clearly that this is some species of hepatocystis:&lt;/p>
&lt;p>&lt;img class="alignnone size-full wp-image-141" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/04/analysis-copy.png" alt="" width="709" height="1146" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2018/04/analysis-copy.png 709w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/04/analysis-copy-186x300.png 186w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/04/analysis-copy-634x1024.png 634w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px" />&lt;/p>
&lt;p>The closest relative found here is from a &lt;a href="https://www.ncbi.nlm.nih.gov/nuccore/eu254616.1" target="_blank" rel="noopener">&lt;em>Cynopterus brachyotis&lt;/em> bat from Singapore&lt;/a> – bats seem to pick up everything!&lt;/p>
&lt;p>This is about as far as I’ve got with this. Some thoughts at this point:&lt;/p>
&lt;ul>
&lt;li>If you are interested in what a specific gene looks like in hepatocystis it is likely that you can find at least part of it in these colobus contigs to compare to. It is very easy to run &lt;a href="https://www.ncbi.nlm.nih.gov/assembly/1441961" target="_blank" rel="noopener">a BLAST search at NCBI to check&lt;/a>.&lt;/li>
&lt;li>Early data-release is awesome! Parasitologists will really benefit from the University of Oregon primate researchers making this data available.&lt;/li>
&lt;li>Someone should really see if we can get a really decent genome from these short read sequences. The library was prepared with Chromium technology and assembled with SuperNova, a 10X assembler. Is it possible these methods are optimised for diploid sequences and that assembling the raw data might enable a better parasite assembly? Or maybe the current assembly is pretty good – apart from the gaps – and missing _Plasmodium _genes are truly missing due to the differences in the hepatocystis lifecycle?&lt;/li>
&lt;li>The depositors of the assembly might wish to partition it into its monkey and hepatocystis portions as I have above, lest a lot of parasite researchers are going to get confused when they find their parasite to be so closely related to a monkey 🙂 Happy to share my assignments!&lt;/li>
&lt;/ul></description></item><item><title>Saving 99.5%: automating a manual microscope with a 3D printed adapter</title><link>/blog/2018/02/01/save-99-5-upgrading-a-manual-microscope-with-an-automated-stage-for-60/</link><pubDate>Thu, 01 Feb 2018 14:30:41 +0000</pubDate><guid>/blog/2018/02/01/save-99-5-upgrading-a-manual-microscope-with-an-automated-stage-for-60/</guid><description>&lt;p>**TL;DR: **Some 3D-printing hackery can create an automated microscope stage from a manual stage for ~0.5% of the cost from the manufacturer.&lt;/p>
&lt;p>&lt;img class="alignnone size-full wp-image-80" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/01/giphy3.gif" alt="" width="480" height="270" />&lt;/p>
&lt;hr>
&lt;p>I have always wanted access to a microscope with an automated stage. The ability to scan an entire slide/plate for a cell of interest seems to unlock a wealth of new possibilities.&lt;/p>
&lt;p>Sadly, these systems cost quite a bit. The lab I work in now has a Leica DMi8 microscope with automated movement in Z. But XY movement is (on our model) still manual. It is possible to purchase an automated XY stage for this microscope, but the list-price quote is around £12,000 (including stage, and control hardware and software).&lt;/p>
&lt;p>I’m not going to argue that this price is unreasonable. I am sure that the manufacturers of scientific equipment spend a lot of time and money innovating, and that money has to be made back by selling devices which have relatively small production runs. Nevertheless, the result is that the costs of kit that makes it to market are fairly staggering – and this prevents someone like me from being able to play around with an automated stage.&lt;/p>
&lt;p>But I still wanted to experiment with an automated stage! So I wondered how easy this would be to do myself. After all, we have a manual stage, and we move it by rotating two knobs. Couldn’t I just get motors to turn those instead of doing it with my hand?&lt;/p>
&lt;p>As I thought this through further I realised it was slightly complicated than this. Firstly, the knobs are co-axial, making them rather harder to deal with than would be two separate shafts. And secondly, as you rotate the X-knob, the shaft moves in X.&lt;/p>
&lt;p>&lt;img class="alignnone wp-image-62 size-full" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/01/ezgif-1-2c888ba693.gif" alt="" width="600" height="338" />&lt;/p>
&lt;p>So the motors need to be able to move with it. But they also need to be to rotate and exert a twisting force on the knob – so they need to move linearly but be locked in one orientation.&lt;/p>
&lt;p>&lt;strong>Hardware: 3D printed pieces, 2 stepper motors and a RAMPS controller&lt;/strong>&lt;/p>
&lt;p>I made a quick design in OpenSCAD&lt;/p>
&lt;p>&lt;img class="alignnone size-medium wp-image-64" src="/post/archive_posts/old_wp_images/wp-content/uploads/2018/01/design-300x289.png" alt="" width="300" height="289" srcset="/post/archive_posts/old_wp_images/wp-content/uploads/2018/01/design-300x289.png 300w, /post/archive_posts/old_wp_images/wp-content/uploads/2018/01/design.png 500w" sizes="(max-width: 300px) 85vw, 300px" />&lt;/p>
&lt;p>Basically the first knob,which controls movement in Y, is simply connected to the mechanism by a (red) sleeve which connects to a motor below. The knob above, which controls movement in X, is placed inside a (blue) sleeve which covers it in a gear. That gear is turned by a (turquoise) gear turned by a second motor. Both motors are mounted on a (transparent) piece which also connects them to a LM6LUU linear bearing which allows them to slide but keeps their orientation constant.&lt;/p>
&lt;p>I printed out these 3 pieces – then tweaked the dimensions a little to be more snug on the knobs and printed them again. The final STL files, and the SCAD file that generated them are available on &lt;a href="https://www.thingiverse.com/thing:2778053" target="_blank" rel="noopener">Thingiverse&lt;/a>.&lt;/p>
&lt;p>To control it I connected the steppers to a trusty RAMPS 3D printer controller. These cost £30 with a screen and a rocker controller (the Leica hardware to control a stage is ~£3k). Since the 3D printer controller is also all set up to control the temperature of a hot-end and a heated bed, if you want to add warm stage down the line this might be ideal.&lt;/p>
&lt;p>Initial tests controlling the position using the system using the RAMPS controller went well, and let me calibrate the number of steps per micrometer.&lt;/p>
&lt;p>&lt;iframe src="https://www.youtube.com/embed/qiW8ZmzKFb0" width="560" height="315" frameborder="0" allowfullscreen="allowfullscreen">&lt;/iframe>&lt;/p>
&lt;h3 id="software-micromanager">Software: MicroManager&lt;/h3>
&lt;p>Regrettably, the Leica software isn’t going to allow you to easily hook it up to an Arduino-based controller. But, as ever, open-source software comes to the rescue. &lt;a href="https://micro-manager.org" target="_blank" rel="noopener">Micro-Manager&lt;/a> is a very advanced ImageJ plugin that can connect to the Leica camera, and to the microscope itself to control filter cube positions, Z-focusing, etc.&lt;/p>
&lt;p>Don’t expect quite the user-friendliness of Leica software from Micro-Manager, but _do _expect a wealth of packages to perform common operations in automated-microscopy (Leica charges ~£2.5k for the software to revisit a position multiple times – which was included in the quote given above).&lt;/p>
&lt;p>Theoretically, MicroManager &lt;em>even&lt;/em> allows you to control XY position using a RAMPS controller – someone has already written a package for exactly this board. This step, which should have been trivial, was actually the most complicated. The device adapter is designed to ask the RAMPS controller for its version, and somehow I could never make my board submit a response that the software was happy with. I had to download the MicroManager source and remove the code that checked the version. Successfully setting up the build environment for Windows took an age. Do get in touch if you have a similar project and want the DLL I built [update: DLL &lt;a href="/post/archive_posts/old_wp_images/wp-content/mmgr_dal_RAMPS.dll">here&lt;/a>, I offer no guarantees at all that it will work. This is an x64 build which will only work with a &lt;a href="http://valelab4.ucsf.edu/~MM/nightlyBuilds/1.4/Windows/MMSetup_64bit_1.4.23_20180131.exe" target="_blank" rel="noopener">recent nightly build&lt;/a>] [update 2: &lt;a href="https://twitter.com/nvladimus/status/1050047856135073792" target="_blank" rel="noopener">Nikita Vladimirov&lt;/a> has followed up on this and released the &lt;a href="https://github.com/nvladimus/micro-manager" target="_blank" rel="noopener">changes&lt;/a> he had to make to MicroManager]. Anyway, to cut a long story short I got MicroManager to talk to the RAMPS board successfully.&lt;/p>
&lt;h3 id="testing-by-making-a-100x-oil-immersion-slide-scanner">Testing by making a 100X oil immersion slide scanner&lt;/h3>
&lt;p>Now to put it into practice.&lt;/p>
&lt;p>I wrote a Beanshell script to scan a slide in X and Y and capture images. In this case I captured images in a grid 40 microscope images wide by 30 microscope images high, for a total of 1200 images.&lt;/p>
&lt;p>&lt;iframe src="https://www.youtube.com/embed/hqaQOWkytuY" width="560" height="315" frameborder="0" allowfullscreen="allowfullscreen">&lt;/iframe>&lt;/p>
&lt;p>This took a few minutes – try doing that by hand.. Then I stitched them together with the &lt;a href="https://www.nature.com/articles/s41598-017-04567-y" target="_blank" rel="noopener">MIST plugin&lt;/a>. The result is a 27,000 x 12,000 pixel image, featuring a whole lot of red blood cells. You can zoom in on the version below. This was taken with a 100X oil immersion objective, at which magnification the smallest motion of the stage is a substantial fraction of the image, but still allows enough overlap for stitching.&lt;/p>
&lt;p>&lt;script src="https://scripts.sirv.com/sirv.js">&lt;/script>&lt;/p>
&lt;div class="Sirv" style="height: 400px; width: 100%;" data-effect="zoom">&lt;img data-src="https://smoncett.sirv.com/huge2%20copy.jpg" />&lt;/div>
&lt;p>Fun! Still a bit more experimenting to do, but I’m hoping to get this acquiring tagged proteins from 96-well plates.&lt;/p>
&lt;p>&lt;em>Caveat for anyone who tries to implement this: obviously be very careful not to create significant non-twisting forces on the coaxial knobs – you don’t want to damage your stage and ruin the alignment.&lt;/em>&lt;/p></description></item><item><title>New beginnings</title><link>/blog/2017/11/25/hello-world/</link><pubDate>Sat, 25 Nov 2017 12:54:07 +0000</pubDate><guid>/blog/2017/11/25/hello-world/</guid><description>&lt;p>&lt;a href="http://theo.io/Investigating the Plasmodium invadome using high-throughput reverse genetics.pdf" data-wplink-url-error="true">Thesis PDF&lt;/a>&lt;/p></description></item><item><title>Petition grapher</title><link>/blog/2017/01/15/petition-grapher/</link><pubDate>Sun, 15 Jan 2017 23:45:58 +0000</pubDate><guid>/blog/2017/01/15/petition-grapher/</guid><description>&lt;p>The houses of parliament in the UK host a website of petitions. When a particularly popular petition is trending it can be addictive to refresh the page and watch the numbers going up behind your eyes. But of course what one really wants is a graph.&lt;/p>
&lt;p>So I built &lt;a href="http://splasho.com/petitions/" target="_blank" rel="noopener">this tool&lt;/a> which regularly queries the parliament API and stores historical petition signatures in a database which it uses to draw graphs.&lt;/p></description></item><item><title>The Up-Goer Five Text Editor</title><link>/blog/2013/01/15/the-up-goer-five-text-editor/</link><pubDate>Tue, 15 Jan 2013 20:30:09 +0000</pubDate><guid>/blog/2013/01/15/the-up-goer-five-text-editor/</guid><description>&lt;p>When Randall Monroe released the amazing &lt;a href="https://www.google.co.uk/url?sa=t&amp;amp;rct=j&amp;amp;q=&amp;amp;esrc=s&amp;amp;source=web&amp;amp;cd=5&amp;amp;ved=0ahUKEwiL_IDW7YzYAhWpDsAKHUphCa4QFgg_MAQ&amp;amp;url=https%3A%2F%2Fxkcd.com%2F1133%2F&amp;amp;usg=AOvVaw34iEgfQhC5LA5KI54OHFCk" target="_blank" rel="noopener">Up-Goer Five comic&lt;/a>, I was inspired to hack together a &lt;a href="http://splasho.com/upgoer5/" target="_blank" rel="noopener">customised editor&lt;/a> so that I could explain my own research in the limited vocabulary of the thousand most common words.&lt;/p>
&lt;p>For me the most exciting bit about this was that I got an email from Mr. xkcd himself. It also became a bit of a science-communication craze. A lot of scientists got in on the action (some kind people have made a collection &lt;a href="http://tenhundredwordsofscience.tumblr.com/" target="_blank" rel="noopener">here&lt;/a>).&lt;/p>
&lt;p>The editor has featured in &lt;a href="https://www.theguardian.com/technology/shortcuts/2013/jan/22/up-goer-five-thing-on-computer" target="_blank" rel="noopener">The Guardian&lt;/a> (and &lt;a href="https://www.theguardian.com/science/life-and-physics/2013/jan/19/upgoerfive-particlephysics" target="_blank" rel="noopener">again&lt;/a>). More recently it’s even been used for &lt;a href="https://www.youtube.com/watch?v=eqOK8SOhSTc&amp;amp;index=2&amp;amp;list=PLxxOU26Ed0qfQYwboB9WpaXpxZdZMG2ae" target="_blank" rel="noopener">conference sessions&lt;/a>, which are pretty fantastic. (The &lt;a href="https://www.youtube.com/watch?v=D7BtHOGEXhc&amp;amp;index=9&amp;amp;list=PLxxOU26Ed0qfQYwboB9WpaXpxZdZMG2ae" target="_blank" rel="noopener">9th talk&lt;/a> in that playlist is particularly excellent). It’s also quite popular as a science communication training exercise, although it goes without saying that no-one is suggesting that this is the best way to communicate.&lt;/p></description></item><item><title>iGEM</title><link>/blog/2010/08/15/igem/</link><pubDate>Sun, 15 Aug 2010 19:33:04 +0000</pubDate><guid>/blog/2010/08/15/igem/</guid><description>&lt;p>The international genetic engineered machine competition (iGEM) was my first taste of proper experimental science, and I still have a fondness for synthetic biology. I was part of the &lt;a href="http://2010.igem.org/Team:Cambridge" target="_blank" rel="noopener">Cambridge Team&lt;/a> for 2010. This was an exciting team project where we got to define our own genetic engineering project and work on it over a summer.&lt;/p>
&lt;p>We focused on bioluminescence, building modular genetic components (BioBricks) from firefly luciferase, in a number of colours, and also from the bacterium &lt;em>Vibrio fischeri&lt;/em>. The exciting thing about the bacterial luciferase is that this permits ‘autoluminescence’, i.e. the bacteria produce light without adding any other chemicals. We exploited this to light ourselves in the photo below.&lt;/p>
&lt;p>&lt;img class="alignnone size-medium" src="http://2010.igem.org/wiki/images/7/70/Front.jpg" width="738" height="240" />&lt;/p>
&lt;p>In the project we achieved a Gold Medal, were finalists in the competition and won the prize for Best Wiki, which I designed. As part of the project I built &lt;a href="http://2010.igem.org/Team:Cambridge/Tools/GenBank" target="_blank" rel="noopener">BioBrick2GenBank&lt;/a>, a small tool which converts BioBricks to GenBank format for editing in standard cloning software. This has been used &amp;gt;350,000 times to date.&lt;/p>
&lt;p>Our BioBricks have been used by a number of future teams, including by a &lt;a href="http://2012.igem.org/Team:Peking/Project/Communication" target="_blank" rel="noopener">team from Peking&lt;/a>, who used this part in one bacterium, combined with a light sensitive-system in bacteria in a separate tube, to allow cell-cell communication!&lt;/p>
&lt;p>&lt;strong>Gibson assembly&lt;/strong>&lt;/p>
&lt;p>We were also early users of the revolutionary Gibson Assembly protocol, and I penned the lyrics to the &lt;a href="https://www.youtube.com/watch?v=WCWjJFU1be8" target="_blank" rel="noopener">embarassing music-video we made to promote it&lt;/a>, earning us the (dubious?) distinction of a &lt;a href="https://twitter.com/jcventer/status/26709268422" target="_blank" rel="noopener">Craig Venter tweet&lt;/a>.&lt;/p>
&lt;p>&lt;strong>Media&lt;/strong>&lt;/p>
&lt;p>On the back of this project I was quoted in &lt;a href="https://www.newscientist.com/article/mg20827885-000-glowing-trees-could-light-up-city-streets/" target="_blank" rel="noopener">New Scientist&lt;/a>, and later by &lt;a href="http://www.bbc.co.uk/news/technology-22433866" target="_blank" rel="noopener">the&lt;/a> &lt;a href="http://www.bbc.co.uk/news/science-environment-21144766" target="_blank" rel="noopener">BBC&lt;/a>.&lt;/p>
&lt;p>&lt;strong>Book chapter&lt;/strong>&lt;/p>
&lt;p>Ben Reeve and I later wrote a &lt;a href="https://www.ncbi.nlm.nih.gov/pubmed/25216951" target="_blank" rel="noopener">chapter&lt;/a> about the application of bioluminescence in synthetic biology.&lt;/p></description></item></channel></rss>