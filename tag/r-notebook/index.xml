<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>R notebook | Theo Sanderson</title><link>/tag/r-notebook/</link><atom:link href="/tag/r-notebook/index.xml" rel="self" type="application/rss+xml"/><description>R notebook</description><generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><lastBuildDate>Thu, 21 Jan 2021 17:58:37 +0000</lastBuildDate><image><url>/images/icon_hu141e5746c4390abcaff97a6bd8371d9c_4466_512x512_fill_lanczos_center_2.png</url><title>R notebook</title><link>/tag/r-notebook/</link></image><item><title>Investigating the latest round of REACT</title><link>/post/2021-01-21-react/</link><pubDate>Thu, 21 Jan 2021 17:58:37 +0000</pubDate><guid>/post/2021-01-21-react/</guid><description>&lt;p>The &lt;a href="https://spiral.imperial.ac.uk/handle/10044/1/85583" target="_blank" rel="noopener">latest round of the REACT study&lt;/a> has come out, and been quite controversial. Let&amp;rsquo;s examine some of the raw data behind it.&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='kr'>&lt;a href='https://rdrr.io/r/base/library.html'>library&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>&lt;a href='http://tidyverse.tidyverse.org'>tidyverse&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>Let&amp;rsquo;s download the REACT data and process it into a nice format:&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nv'>positive&lt;/span> &lt;span class='o'>&amp;lt;-&lt;/span> &lt;span class='nf'>read_csv&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/connections.html'>url&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"https://raw.githubusercontent.com/mrc-ide/reactidd/master/inst/extdata/positive.csv"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='c'>#&amp;gt; Warning: Missing column names filled in: 'X1' [1]&lt;/span>
&lt;span class='nv'>total&lt;/span> &lt;span class='o'>&amp;lt;-&lt;/span> &lt;span class='nf'>read_csv&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/connections.html'>url&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"https://raw.githubusercontent.com/mrc-ide/reactidd/master/inst/extdata/total.csv"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='c'>#&amp;gt; Warning: Missing column names filled in: 'X1' [1]&lt;/span>
&lt;/code>&lt;/pre>
&lt;/div>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nv'>positive&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>type&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='s'>"positive"&lt;/span>
&lt;span class='nv'>total&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>type&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='s'>"total"&lt;/span>
&lt;span class='nv'>all&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nf'>bind_rows&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>positive&lt;/span>, &lt;span class='nv'>total&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/colnames.html'>colnames&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>all&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>[&lt;/span>&lt;span class='m'>1&lt;/span>&lt;span class='o'>]&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='s'>"Date"&lt;/span>
&lt;span class='nv'>all&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nv'>all&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>pivot_longer&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/c.html'>c&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>-&lt;/span>&lt;span class='nv'>Date&lt;/span>,&lt;span class='o'>-&lt;/span>&lt;span class='nv'>type&lt;/span>&lt;span class='o'>)&lt;/span>,names_to&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Region"&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>pivot_wider&lt;/span>&lt;span class='o'>(&lt;/span>names_from&lt;span class='o'>=&lt;/span>&lt;span class='nv'>type&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>all&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'># A tibble: 1,485 x 4&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; Date Region positive total&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;font-style: italic;'>&amp;lt;date&amp;gt;&lt;/span>&lt;span> &lt;/span>&lt;span style='color: #555555;font-style: italic;'>&amp;lt;chr&amp;gt;&lt;/span>&lt;span> &lt;/span>&lt;span style='color: #555555;font-style: italic;'>&amp;lt;dbl&amp;gt;&lt;/span>&lt;span> &lt;/span>&lt;span style='color: #555555;font-style: italic;'>&amp;lt;dbl&amp;gt;&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 1&lt;/span>&lt;span> 2020-05-05 South East 0 113&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 2&lt;/span>&lt;span> 2020-05-05 North East 0 13&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 3&lt;/span>&lt;span> 2020-05-05 North West 1 73&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 4&lt;/span>&lt;span> 2020-05-05 Yorkshire and The Humber 0 33&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 5&lt;/span>&lt;span> 2020-05-05 East Midlands 1 77&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 6&lt;/span>&lt;span> 2020-05-05 West Midlands 0 51&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 7&lt;/span>&lt;span> 2020-05-05 East of England 0 93&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 8&lt;/span>&lt;span> 2020-05-05 London 0 39&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'> 9&lt;/span>&lt;span> 2020-05-05 South West 0 42&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'>10&lt;/span>&lt;span> 2020-05-06 South East 0 62&lt;/span>&lt;/span>
&lt;span class='c'>#&amp;gt; &lt;span style='color: #555555;'># … with 1,475 more rows&lt;/span>&lt;/span>m
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>Now we can calculate binomial confidence intervals by location for each date and plot them.&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nv'>all&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nv'>all&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>!&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/NA.html'>is.na&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>positive&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>!&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/r/base/NA.html'>is.na&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>total&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='kr'>&lt;a href='https://rdrr.io/r/base/library.html'>library&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>binom&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>cis&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/pkg/binom/man/binom.confint.html'>binom.confint&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>all&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>positive&lt;/span>,&lt;span class='nv'>all&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>total&lt;/span>, method&lt;span class='o'>=&lt;/span>&lt;span class='s'>"exact"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>all&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>lower&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nv'>cis&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>lower&lt;/span>
&lt;span class='nv'>all&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>mean&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nv'>cis&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>mean&lt;/span>
&lt;span class='nv'>all&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>upper&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nv'>cis&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>upper&lt;/span>
&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>all&lt;/span> &lt;span class='o'>%&amp;gt;%&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/r/stats/filter.html'>filter&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>Date&lt;/span>&lt;span class='o'>&amp;gt;&lt;/span>&lt;span class='s'>"2020-12-15"&lt;/span>&lt;span class='o'>)&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>Date&lt;/span>,ymin&lt;span class='o'>=&lt;/span>&lt;span class='nv'>lower&lt;/span>,ymax&lt;span class='o'>=&lt;/span>&lt;span class='nv'>upper&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>mean&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_pointrange&lt;/span>&lt;span class='o'>(&lt;/span>color&lt;span class='o'>=&lt;/span>&lt;span class='s'>"black"&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span>&lt;span class='nf'>facet_wrap&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>~&lt;/span>&lt;span class='nv'>Region&lt;/span>,scales&lt;span class='o'>=&lt;/span>&lt;span class='s'>"free_y"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>scale_y_log10&lt;/span>&lt;span class='o'>(&lt;/span>labels &lt;span class='o'>=&lt;/span> &lt;span class='nf'>scales&lt;/span>&lt;span class='nf'>::&lt;/span>&lt;span class='nv'>&lt;a href='https://scales.r-lib.org//reference/label_percent.html'>percent&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>theme_bw&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span> &lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>y&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Probability of testing positive"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='c'>#&amp;gt; Warning: Transformation introduced infinite values in continuous y-axis&lt;/span>
&lt;span class='c'>#&amp;gt; Warning: Transformation introduced infinite values in continuous y-axis&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-4-1.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>
&lt;span class='nf'>ggsave&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"plot.png"&lt;/span>,width&lt;span class='o'>=&lt;/span>&lt;span class='m'>9&lt;/span>,height&lt;span class='o'>=&lt;/span>&lt;span class='m'>5&lt;/span>, type&lt;span class='o'>=&lt;/span>&lt;span class='s'>"cairo"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='c'>#&amp;gt; Warning: Transformation introduced infinite values in continuous y-axis&lt;/span>
&lt;span class='c'>#&amp;gt; Warning: Transformation introduced infinite values in continuous y-axis&lt;/span>
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>This looks to accord well with the table of R values that REACT provide in Table 3: &lt;img src="react-table.png" alt="">&lt;/p>
&lt;p>This isn&amp;rsquo;t especially surprising, but I think the visualisation helps to make sense of how these values came to be calculated (even though they are probably based on a more complex analysis weighting for various demographic factors).&lt;/p>
&lt;p>That&amp;rsquo;s it for now.&lt;/p></description></item><item><title>The virus vs. the vaccine</title><link>/post/2021-01-21-vaccine-virus/</link><pubDate>Thu, 21 Jan 2021 16:58:37 +0000</pubDate><guid>/post/2021-01-21-vaccine-virus/</guid><description>&lt;p>One framing for thinking about COVID is as a race between vaccination and infection, since we expect the former to have at least some mitigating effect on the latter. To get a sense for this I plot the cumulative infection estimates from the &lt;a href="https://www.mrc-bsu.cam.ac.uk/tackling-covid-19/nowcasting-and-forecasting-of-covid-19/" target="_blank" rel="noopener">MRC Biostatistics Nowcasting Reports&lt;/a> against the vaccination numbers from &lt;a href="https://coronavirus.data.gov.uk/details/healthcare" target="_blank" rel="noopener">PHE&lt;/a> (with historical data filled in from &lt;a href="https://ourworldindata.org/covid-vaccinations" target="_blank" rel="noopener">Our World in Data&lt;/a>).&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='kr'>&lt;a href='https://rdrr.io/r/base/try.html'>try&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='kr'>&lt;a href='https://rdrr.io/r/base/library.html'>library&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>&lt;a href='http://tidyverse.tidyverse.org'>tidyverse&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span>, silent&lt;span class='o'>=&lt;/span>&lt;span class='kc'>TRUE&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='kr'>&lt;a href='https://rdrr.io/r/base/library.html'>library&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>&lt;a href='https://arxiv.org/abs/1403.2805'>jsonlite&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='kr'>&lt;a href='https://rdrr.io/r/base/library.html'>library&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>&lt;a href='http://github.com/jrnold/ggthemes'>ggthemes&lt;/a>&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>a&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nf'>&lt;a href='https://rdrr.io/pkg/jsonlite/man/fromJSON.html'>fromJSON&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"mrc_biostats.json"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>df&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nf'>tibble&lt;/span>&lt;span class='o'>(&lt;/span>date&lt;span class='o'>=&lt;/span>&lt;span class='nv'>a&lt;/span>&lt;span class='o'>[[&lt;/span>&lt;span class='m'>1&lt;/span>&lt;span class='o'>]&lt;/span>&lt;span class='o'>]&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>a&lt;/span>&lt;span class='o'>[[&lt;/span>&lt;span class='m'>2&lt;/span>&lt;span class='o'>]&lt;/span>&lt;span class='o'>]&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>df&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>date&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nf'>lubridate&lt;/span>&lt;span class='nf'>::&lt;/span>&lt;span class='nf'>&lt;a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>df&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>date&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>df&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>label&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='s'>"People infected"&lt;/span>
&lt;span class='nv'>b&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='nf'>read_csv&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"vaccinations.csv"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>b&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>y&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nv'>b&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>numFirstDose&lt;/span>
&lt;span class='nv'>b&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>date&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nf'>lubridate&lt;/span>&lt;span class='nf'>::&lt;/span>&lt;span class='nf'>&lt;a href='http://lubridate.tidyverse.org/reference/ymd.html'>dmy&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>b&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>date&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;span class='nv'>b&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>label&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='s'>"People vaccinated"&lt;/span>
&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nf'>bind_rows&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>df&lt;/span>,&lt;span class='nv'>b&lt;/span>&lt;span class='o'>)&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>date&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>y&lt;/span>&lt;span class='o'>/&lt;/span>&lt;span class='m'>1000000&lt;/span>,color&lt;span class='o'>=&lt;/span>&lt;span class='nv'>label&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_line&lt;/span>&lt;span class='o'>(&lt;/span>size&lt;span class='o'>=&lt;/span>&lt;span class='m'>1&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span>&lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Date"&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Number of people (millions)"&lt;/span>,color&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Type"&lt;/span>,title&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Infection and vaccination levels in England"&lt;/span>,caption&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Data sources: MRC Biostatistics Unit (cumulative infection estimates)\nOur World In Data &amp;amp; PHE (vaccination figures – at least one dose)"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/pkg/ggthemes/man/theme_hc.html'>theme_hc&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>+
&lt;span class='nf'>theme&lt;/span>&lt;span class='o'>(&lt;/span>plot.title &lt;span class='o'>=&lt;/span> &lt;span class='nf'>element_text&lt;/span>&lt;span class='o'>(&lt;/span>hjust &lt;span class='o'>=&lt;/span> &lt;span class='m'>0.5&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-1-1.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>&lt;span class='nf'>ggsave&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"plot.png"&lt;/span>,width&lt;span class='o'>=&lt;/span>&lt;span class='m'>7.3&lt;/span>,height&lt;span class='o'>=&lt;/span>&lt;span class='m'>4&lt;/span>, type &lt;span class='o'>=&lt;/span> &lt;span class='s'>"cairo"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>If we literally were to imagine vaccination and infection to be mutually exclusive (which clearly isn&amp;rsquo;t true in either direction), we could plot a graph like this to look at where they might meet.&lt;/p>
&lt;div class="highlight">
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>
&lt;span class='nv'>c&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='nv'>b&lt;/span>
&lt;span class='nv'>c&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>label&lt;/span> &lt;span class='o'>=&lt;/span> &lt;span class='s'>"People unvaccinated"&lt;/span>
&lt;span class='nv'>c&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>y&lt;/span>&lt;span class='o'>=&lt;/span>&lt;span class='m'>56000000&lt;/span>&lt;span class='o'>-&lt;/span>&lt;span class='nv'>c&lt;/span>&lt;span class='o'>$&lt;/span>&lt;span class='nv'>y&lt;/span>
&lt;span class='nf'>ggplot&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nf'>bind_rows&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='nv'>df&lt;/span>,&lt;span class='nv'>c&lt;/span>&lt;span class='o'>)&lt;/span>,&lt;span class='nf'>aes&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='nv'>date&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='nv'>y&lt;/span>&lt;span class='o'>/&lt;/span>&lt;span class='m'>1000000&lt;/span>,color&lt;span class='o'>=&lt;/span>&lt;span class='nv'>label&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>geom_line&lt;/span>&lt;span class='o'>(&lt;/span>size&lt;span class='o'>=&lt;/span>&lt;span class='m'>1&lt;/span>&lt;span class='o'>)&lt;/span> &lt;span class='o'>+&lt;/span>&lt;span class='nf'>labs&lt;/span>&lt;span class='o'>(&lt;/span>x&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Date"&lt;/span>,y&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Number of people (millions)"&lt;/span>,color&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Type"&lt;/span>,title&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Infection and vaccination levels in England"&lt;/span>,caption&lt;span class='o'>=&lt;/span>&lt;span class='s'>"Data sources: MRC Biostatistics Unit (cumulative infection estimates)\nOur World In Data &amp;amp; PHE (vaccination figures – at least one dose)"&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>&lt;span class='nf'>&lt;a href='https://rdrr.io/pkg/ggthemes/man/theme_hc.html'>theme_hc&lt;/a>&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>+&lt;/span>+
&lt;span class='nf'>theme&lt;/span>&lt;span class='o'>(&lt;/span>plot.title &lt;span class='o'>=&lt;/span> &lt;span class='nf'>element_text&lt;/span>&lt;span class='o'>(&lt;/span>hjust &lt;span class='o'>=&lt;/span> &lt;span class='m'>0.5&lt;/span>&lt;span class='o'>)&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="figs/unnamed-chunk-2-1.png" width="700px" style="display: block; margin: auto;" />&lt;/p>
&lt;pre class='chroma'>&lt;code class='language-r' data-lang='r'>
&lt;span class='nf'>ggsave&lt;/span>&lt;span class='o'>(&lt;/span>&lt;span class='s'>"plot2.png"&lt;/span>,width&lt;span class='o'>=&lt;/span>&lt;span class='m'>7.3&lt;/span>,height&lt;span class='o'>=&lt;/span>&lt;span class='m'>4&lt;/span>, type &lt;span class='o'>=&lt;/span> &lt;span class='s'>"cairo"&lt;/span>&lt;span class='o'>)&lt;/span>
&lt;/code>&lt;/pre>
&lt;/div></description></item></channel></rss>