[{"authors":null,"categories":null,"content":"I study the genes of malaria parasites. I am interested in developing the tools needed to provide a better systems-level understanding of these parasites, with a focus on open-source methods for high-throughput culture.\n","date":1596240000,"expirydate":-62135596800,"kind":"term","lang":"en","lastmod":1596240000,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"","publishdate":"0001-01-01T00:00:00Z","relpermalink":"","section":"authors","summary":"I study the genes of malaria parasites. I am interested in developing the tools needed to provide a better systems-level understanding of these parasites, with a focus on open-source methods for high-throughput culture.","tags":null,"title":"Theo Sanderson","type":"authors"},{"authors":[],"categories":null,"content":" Click on the Slides button above to view the built-in slides feature.   Slides can be added in a few ways:\n Create slides using Wowchemy\u0026rsquo;s Slides feature and link using slides parameter in the front matter of the talk file Upload an existing slide deck to static/ and link using url_slides parameter in the front matter of the talk file Embed your slides (e.g. Google Slides) or presentation video on this page using shortcodes.  Further event details, including page elements such as image galleries, can be added to the body of this page.\n","date":1906549200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1906549200,"objectID":"a8edef490afe42206247b6ac05657af0","permalink":"/talk/example-talk/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/talk/example-talk/","section":"event","summary":"An example talk using Wowchemy's Markdown slides feature.","tags":[],"title":"Example Talk","type":"event"},{"authors":["Eerik Aunin","Ulrike Böhme","Theo Sanderson","Noah D. Simons","Tony L. Goldberg","Nelson Ting","Colin A. Chapman","Chris I. Newbold","Matthew Berriman","Adam J. Reid"],"categories":null,"content":"","date":1596240000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1596240000,"objectID":"0913c5c2f829de01bfaf26c4c0d43729","permalink":"/publication/2020-hepatocystis/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/2020-hepatocystis/","section":"publication","summary":"This work began when I did a BLAST search for a malaria parasite gene, and saw a closely matching gene that claimed to be from a monkey. When I investigated further I found that this \"monkey genome\" contained substantial contamination from a genus of parasite called *Hepatocystis* that had been lurking in the monkey's blood. The identification of the first substantial genomic data from this genus, which I initially described in a [blog post](/blog/2018/04/23/how-i-stumbled-upon-a-novel-genome-for-a-malaria-like-parasite-of-apes/), triggered a collaborative project between the originators of the data, former colleagues at the Sanger Institute, and myself to characterise this genome revealing the genomic basis of this parasite's unique biology.","tags":[],"title":"Genomic and transcriptomic evidence for descent from Plasmodium and loss of blood schizogony in Hepatocystis parasites from naturally infected red colobus monkeys","type":"publication"},{"authors":null,"categories":["Uncategorized"],"content":"I recently asked on Twitter:\nAnd got reassuring results:\nThen I asked another question. Have a think about how you might answer it.\nHere is how Twitter responded:\nQuite a difference! Not surprising perhaps. The risk of passing on COVID-19 is lower by a factor of 12,000. Nevertheless, I think that the good people of Twitter are wrong, and will explain why a little further down.\nThe people of Twitter are not alone though, and these sorts of decisions aren’t just thought experiments. The UK government first required people with coughs or fever to isolate themselves on 12 March, long after the virus arrived in the UK. This was part of the government’s strategy of introducing “the right measures at the right time”, and Sir Patrick Vallance gave this as an example, saying that prior to 12 March a very small proportion of people with symptoms would have COVID-19, so it would not make sense to isolate them.\nI’ve seen a similar argument made against mask use. After lockdown a small proportion of people will have COVID, the argument goes, so the chance of any particular mask stopping an infection is tiny:\nWe do this sort of risk analysis all the time. When you go somewhere in a car there is some small chance you could cause an accident in which someone is hurt, but if that risk were 12,000 times higher you would never drive again.\nEven some experts appear to agree:From The Times, 21st April\nBut this argument does not apply for a contagious virus.\nInvestigating with a simple model Practically, someone who stays home in Scenario A (when there is a 99.999% chance they have a cold), has the same impact as someone who stays home when there is a 12% chance they have COVID. One way to see this is to simulate an epidemic, and imagine that we institute an intervention for only a week, either early in the epidemic or late in the epidemic.\nLet’s consider the mass-masking scenario. Without any interventions, each infected person passes the virus on to 2.5 additional people. We’ll exaggerate the effect of masks and imagine that everyone wearing masks reduces that number (R) to 0.8. In reality this magnitude of effect could only be achieved with a package of many interventions. But it makes it easier to see what’s going on with a graph.\nIf we plot the epidemic with a logarithmic y-axis, then the steepness of the line is a reflection of how many people each infected person passes the virus to. So if we don’t implement any interventions, this graph goes up with a constant slope.\nWhat happens if we wait until lots of people have the virus, and then bring in masks for 2 weeks to try to stop them passing it on? Well, it’s as you’d expect. The graph goes up as normal, then goes down as R falls to 0.8 for 2 weeks, then starts going up at the same rate again, but reaches a lower point after 80 days than without the two week intervention.\nIn this case we decided to bring in the 2 week intervention only after at least 1% of people were infected. This seems to make sense. Surely there is no point in making people wear masks when only 0.001% of them have the virus? But let’s check, what happens if we bring in the two weeks much earlier in the epidemic?\nIt turns out that the two weeks early in the epidemic has exactly the same effect on the number of infections on day 80! What matters is that it has the same effect on R in either case. Even though a far lower absolute number of infected people are wearing masks, R is reduced to 0.8 in both cases.\nEthics: how should we each act in the time of COVID-19? As COVID-19 was spreading in our communities, many people advocated for social-distancing measures. One model for doing this is to think about the absolute chance you have of spreading the virus. For example, someone made a graph to discourage people from holding large events by showing that if there are a lot of infections in the community there is a good chance that large events will cause transmission events:\nInterestingly this graph suggests that if one holds a large event when there is a low level of COVID in the community, there is a less negative effect than when there is a high level. But we’ve seen from the models above that this isn’t correct.\nSo how can we decide how to shape our behaviour? I think it makes sense to follow Kant’s “Categorical Imperative“.\n Act only according to that\u0026nbsp;maxim\u0026nbsp;whereby you can, at the same time, will that it should become a universal law.  So imagine if everyone acted as you intend to, and work out what the effect on R would be. If everyone wears masks then, regardless of the level of COVID in the community, R is reduced. If everyone holds large events then, regardless of the level of COVID in the community, R is increased.\nIn the absence of evidence on seroprevalence and immunity, we must aim to keep R below 1 until we have a vaccine. This will drive the level in the community down to near zero. It will allow vulnerable people to go about their lives as normal. However to achieve these levels we must sustain our measures even as levels in the community drop. Even as we believe that only 30 people in the whole country are infected, we must all wear masks. It’s counter-intuitive, but it will work.\n","date":1587475601,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1587475601,"objectID":"eada8f5d9e3bc30488ddf5921ca7bab3","permalink":"/blog/2020/04/21/covid-19-and-the-categorical-imperative/","publishdate":"2020-04-21T13:26:41Z","relpermalink":"/blog/2020/04/21/covid-19-and-the-categorical-imperative/","section":"post","summary":"I recently asked on Twitter:\nAnd got reassuring results:\nThen I asked another question. Have a think about how you might answer it.\nHere is how Twitter responded:\nQuite a difference!","tags":null,"title":"COVID-19 and the categorical imperative","type":"post"},{"authors":null,"categories":["Uncategorized"],"content":"Until recently, the strategy for COVID testing in many countries has been focused on people who have a significantly likelihood of having COVID-19. The need to impose unpleasant social distancing measures, and ultimately complete lock-downs, trades off against how much testing you do in the community. With sufficient community testing, you could suppress COVID in a population without any social distancing measures. This post is an outline of one way one might go about testing 25 million people per week in order to achieve this.\nDecentralised testing Reaching this sort of scale quickly is likely to require a decentralised approach levering existing organisations. The most obvious candidates to do this are schools and larger businesses. Thirteen million people are employed by businesses with more than 50 employees, and there are twelve million children in schools. If these businesses and schools could test everyone within them each week, 25 million tests would be carried out.\nIt’s important to note that this sort of testing is completely different from the testing of symptomatic, or likely infected, individuals. Symptomatic testing rightly requires specialist training, uncomfortable nasopharyngeal swabs, and full PPE for the person testing and the person being tested. This is because there is a high risk of exposure to COVID-19, and because getting a test result wrong could have major implications for care.\nTesting random individuals from a population with low incidence of COVID-19 poses no greater risk than interacting with them in any other way, as colleagues or students. And in this setting a significant rate of false-negatives or false-positives can be tolerated without major consequences.\nTesting procedure In this proposal all of these businesses and schools would be supplied with: simple nasal swabs, frozen plates containing COVID-19 RT-PCR mix, a basic one-button thermocycler, a blue light transilluminator.\nThe employee responsible for testing takes one of the frozen plates out of the freezer and thaws it.\nStudents and employees go up, one by one, to the testing station. Each person takes a nasal swab and swabs their nostril (front-of-nose, not nasopharyx), then places the swab into a well of the plate, and cuts off the swab’s shaft and discards it. They also write their name on a sheet in a box representing this well, then wash their hands.\nOnce the plate is full of samples the employee responsible for testing takes the plate. They seal it, load it into the one-button-thermocycler, and press the button. The thermocycler runs an RT-PCR programme for an hour.\nThe employee takes the plate out of the machine and examines it with the blue light transilluminator. Any positive wells (including a pre-loaded control well) will glow brightly. Negative wells will be dull.\nIf the employee notices any positive wells (a very rare occurence) they immediately look at the sheet of names and contact the person in question to ask them to report to public health authorities for confirmatory testing. If this test comes back positive then contact-tracing begins.\nThe aim would be to test each person at these schools and businesses once each week.\nCosts and availability The reagents for this test cost much less that £1 per tested person.\nA thermocycler is a simple device which can be currently be purchased for £3,200, and likely manufactured for much less. Unlike ventilators, these could be relatively easily produced by other manufacturers. There would be a definite need to scale up production to achieve this scale.\nA blue light transilluminator can be made for less than £40 from commonly available materials.\nIt seems likely that, despite their low-cost, global supplies of RT-PCR enzymes are insufficient for this scale of testing at present. But there is no reason I am aware of to think that this could not easily be scaled up. The quantities of primers needed are readily available.\nThere might be a need to scale up the production of the DNA-binding dye.\nAll of these costs are minuscule compared to the economic losses averted by preventing a lock-down.\n","date":1587302926,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1587302926,"objectID":"87601f325e40c18062c76d4709b5fa33","permalink":"/blog/2020/04/19/community-testing-for-covid-19-reaching-25-million-tests-per-week/","publishdate":"2020-04-19T13:28:46Z","relpermalink":"/blog/2020/04/19/community-testing-for-covid-19-reaching-25-million-tests-per-week/","section":"post","summary":"Until recently, the strategy for COVID testing in many countries has been focused on people who have a significantly likelihood of having COVID-19. The need to impose unpleasant social distancing measures, and ultimately complete lock-downs, trades off against how much testing you do in the community.","tags":null,"title":"Community testing for COVID-19: reaching 25  million tests per week","type":"post"},{"authors":null,"categories":["Uncategorized"],"content":"Update: it seems (although clarity is lacking) that the UK has moved away from the herd-immunity strategy. I very much welcome this. It renders the argument below irrelevant, except as an illustration of the weaknesses of a strategy that seeks to vaccinate a population using an epidemic.\nDisclaimer: I am neither a virologist, nor an immunologist, nor an epidemiologist. This post is written with confidence, because too many caveats hinder clarity, but should be understood to be the thoughts of a layperson. This week the policy of the UK government on COVID-19, under advice from scientists, has been articulated clearly for the first time. The government intends for around 60% of the population to be infected with COVID-19 in the anticipation that after the majority who survive recover, the population as a whole will have ‘herd immunity’ to the virus, since if only 40% of the population can pass on the virus it will be unable to spread.\nOne can argue about the wisdom of the policy, which is in disagreement with the position of the WHO and many other countries. This post is not about that. What I am interested in is: given this policy (to allow 60% of the population to become infected), what is the least bad way to achieve this? For instance, should you let the virus spread at random through the population or should you actively infect people with the virus under very controlled conditions to minimise the risks?\nThe current approach\nThe government’s approach is to allow the virus to spread with relatively few restrictions initially. At a point before it overwhelms the healthcare system, it will introduce further social-distancing measures to attempt to “flatten the curve” and spread the 40 million infections over a longer time. There will also be some measures to try to ensure that the most vulnerable – older and immunocompromised people – are isolated, but it is unclear how effectively this can be achieved.\nRisks of the current approach\n**Infecting the vulnerable. ~**20% of the UK population is over 65. The fatality rate appears at least 10x higher in this demographic group, hence the government’s attempts to isolate them. At a point where a substantial portion of the population has the virus it is likely to be very difficult to achieve this. If the 60% of the 3.2 million people over 80 became infected, and the fatality rate of 14% for this age-group from China applied then that would represent 270,000 deaths in this age group alone.\nOverloading the healthcare system. Exponential growth is a powerful adversary and small miscalculations could result in overloading the healthcare system with the result that many people die simply because there are no ventilators available to keep them alive. There is concern among some experts that it will not be possible to flatten the curve enough to ensure that everyone receives adequate care. Exponential growth is difficult to avoid in natural infections because people who get the virus will not initially know that they have it, and so will unknowingly spread it to others.\nViral load. There are reasons to expect that the more particles of virus a person is exposed to initially, the more likely they are to experience severe disease. In the government’s approach there is no control over this and so it is possible that young and healthy people may develop severe symptoms due to exposure to a large viral load.\nAn alternative approach\nWe have seen that the government actively intends for 60% of people to get the virus. It is almost as if it were to simply go and infect people, as at a chicken-pox party. So why not actually do this? Could there be advantages to actively exposing 60% of people in a controlled way to the virus to generate the same herd immunity?\nAdvantages the controlled exposure approach\nNot infecting the vulnerable  – only fit and healthy people would be selected to receive the virus. Almost no children under 10 have developed severe symptoms from COVID-19. It would therefore seem very safe to put all immunocompetent children into the 60% who get the virus. Other young people are also comparatively resilient to the virus, and so a utilitarian argument would suggest they would be the safest people to inoculate with the virus. We will see below that this approach may be safer for the people who get infected, than the alternative policy of letting the virus pass through the population.\nNot overloading the healthcare system  – there are two ways in which this controlled approach would avoid overloading the healthcare system. Firstly, by avoiding exponential growth: those infected would know they had been infected and could be isolated afterwards until they were no longer shedding virus. Once resistant, they could go out into the population, and safely work in crucial roles where they were likely to be exposed to the virus. Secondly by reducing the hospitalisation rate: because these people would be drawn from a much more resilient population the chances of them developing severe symptoms would be much lower. The end result of this would be fewer people in hospitals, meaning that the small(er) number of people who did develop severe symptoms would be able to get adequate care. The end result might be that a 100% chance of being infected, and receiving adequate care if required, might be safer than a 60% chance of being infected with the possibility of developing severe symptoms in a degraded healthcare system, which is dealing with exponential growth and vulnerable patients.\nControlled viral load, and possibility of an attenuated strain – there are several lines of evidence to suggest that the amount of virus one is initially exposed to may be a determinant of whether someone develops severe symptoms. By controlling the infection one could minimise the amount of virus someone is exposed to (while ensuring they develop an immune response). This might again substantially reduce the risk compared to a 60% chance of receiving a random viral load (determined by how near you are to an infected person and how much virus they are shedding). Finally, although proper “no-risk” vaccines are unlikely to be available for some time, my non-expert brain wonders whether it is possible to rapidly develop a version of the virus that would be expected to be mildly attenuated by, for example, leaving the proteins the virus is encoding exactly the same, but altering the “codons” of DNA such that these proteins are likely to be produced less rapidly. The effectiveness of this could not be guaranteed, but on the balance of probabilities it seems very unlikely to be more dangerous than the wild-type virus.\nSummary\nThe government are conducting an experiment in which they will allow 60% of people to be infected. To my mind this is in substance the same as the government randomly choosing 60% of people and actively infecting them with a random load of wild-type virus, but not telling them they are infected with the result that they may spread it to vulnerable people. An alternative approach in which selected resilient people were infected in a controlled manner with a low-dose of an attenuated virus might be safer for the people infected, as well as society at large, than the current strategy.\nDisclaimer\nI am neither a virologist, nor an immunologist, nor an epidemiologist. I would welcome explanations of where this argument falls down from such people, or anyone else. Furthermore, I am not arguing for this approach as superior to a containment strategy, merely as superior to a strategy of natural infection. Finally, this is a suggestion for an organised governmental approach, not a DIY ‘chicken-pox party approach’ which would not control viral load and would therefore have great risk.\n","date":1584191068,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1584191068,"objectID":"0f98dfc40d72258c7f3068f08f353ada","permalink":"/blog/2020/03/14/controlled-infection-with-covid-19-as-a-safer-means-of-establishing-herd-immunity/","publishdate":"2020-03-14T13:04:28Z","relpermalink":"/blog/2020/03/14/controlled-infection-with-covid-19-as-a-safer-means-of-establishing-herd-immunity/","section":"post","summary":"Update: it seems (although clarity is lacking) that the UK has moved away from the herd-immunity strategy. I very much welcome this. It renders the argument below irrelevant, except as an illustration of the weaknesses of a strategy that seeks to vaccinate a population using an epidemic.","tags":null,"title":"Controlled infection with COVID-19 as a safer means of establishing herd immunity","type":"post"},{"authors":[],"categories":[],"content":"Create slides in Markdown with Wowchemy Wowchemy | Documentation\n Features  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides   Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E   Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)   Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = ;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\n Fragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  Two  Three \n A fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears   Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view    Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links    night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links   Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/media/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}   Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }   Questions? Ask\nDocumentation\n","date":1549324800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1549324800,"objectID":"0e6de1a61aa83269ff13324f3167c1a9","permalink":"/slides/example/","publishdate":"2019-02-05T00:00:00Z","relpermalink":"/slides/example/","section":"slides","summary":"An introduction to using Wowchemy's Slides feature.","tags":[],"title":"Slides","type":"slides"},{"authors":null,"categories":["Mini-projects","Projects"],"content":"There are a lot of tweets to PubMed pages – not least from @MalariaPapers. I made PubTweet to enable these to have nice info-boxes, like this:\nEvaluation of automated malaria diagnosis using the Sysmex XN-30 analyser in a clinical setting. https://t.co/ZA0vb59FzQ  \u0026mdash; Malaria Papers (@MalariaPapers) January 24, 2019  ","date":1548387802,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1548387802,"objectID":"8f4eb741cca780acb9a371b49b312632","permalink":"/blog/2019/01/25/pubtweet/","publishdate":"2019-01-25T03:43:22Z","relpermalink":"/blog/2019/01/25/pubtweet/","section":"post","summary":"There are a lot of tweets to PubMed pages – not least from @MalariaPapers. I made PubTweet to enable these to have nice info-boxes, like this:\nEvaluation of automated malaria diagnosis using the Sysmex XN-30 analyser in a clinical setting.","tags":null,"title":"PubTweet","type":"post"},{"authors":null,"categories":["Uncategorized"],"content":"In my PhD lab we had an epMotion 5075 pipetting robot. I had a like/hate relationship with this machine. Like: it’s an impressive, precision-engineered, piece of hardware. Hate: the software is appalling. Writing protocols for it was slow, frustrating and generally awful, and there was a general lack of flexibility in what one could make it do.\nRecently I heard that the lab was having a clear out, including disposing of this (pricey when purchased) robot and I asked if I could adopt it in preference to the scrapheap, which I was kindly allowed to. I’m not in a wet-lab at the moment so for now it will live in a garage, but I did want to have a peek inside to have a better understanding of how it works, and to work out whether it would be possible to customise it to be more flexible.\nIf I were buying my own scientific hardware I would always go for the upstart companies like OpenTrons and Incuvers which tell you how their hardware works and allow you to do whatever you want with it. With the epMotion, by contrast, if you want to use new labware you have to send a physical version of it to the company which they measure to generate a proprietary calibration file.\nI was given some hope that it might be possible to customise the robot from this video, in which someone has replaced all the electronics of the robot with a standard board for a CNC machine:\n\nBut other than that I could find very little on the internet about what is inside these robots. I think that’s a shame, and now I have one at my disposal, without a warranty. So here is a run-down of what happens when you take it apart, in case it is useful to anyone in a similar position.\nFirst steps\nThe back panels come off very easily with a hex-key and expose the computer that runs the machine. This runs some version of Windows, maybe Windows CE. It has USB and ethernet ports although to my knowledge with my version of this robot these can’t be used for anything useful. In general I doubt there is any easy way to make this computer do anything other than what Eppendorf has programmed it to do, without access to the underlying source code.\nRemoving the top required in my case removing a little bit of double sided tape at either side, in addition to two hex-key bolts.\nThere is a heavy-duty belt for the X axis with a big stepper motor. My robot had been essentially unused for several years and the rail over which the X-carriage runs had become covered with a sticky substance. This caused the motors to stall mid-run, but cleaning them off with some alcohol resolved this issue.\nThe computer that is the brains of the operation \u0026#8211; unfortunately unlikely to be easily repurposable. Basics\nEach of the X, Y and Z axes is controlled by a stepper motor (the X-axis one is this). They each have optical endstops with 4 wires. In the video above these endstops have been replaced with mechanical switches but it really should be possible to use them as-is.\nX-belt and optical end-stop Y-axis stepper motor, belt, and optical end-stop. Cabling\nOne of the challenges of making a many-axis robot is that signals have to be carried to each successive axis, all of which are connected together. So flexible cabling is needed -but at the same time it has to not get in the way or fall into the samples. In the case of the epMotion this is carried out with ribbon cables like this:\nBut it quickly becomes apparent that this cable doesn’t have enough wires to be simply directly connected at the other end to stepper motors / endstops / etc. Instead it seems that this is some sort of serial cable that carries data signals to a series of other microprocessors, one on the robot’s pipetting arm, and one for each of the Y and Z axes, which then interface with the Y motor, Z motor, the tool locking motor, the pipetting motor, the tip-ejecting actuator, and the range-detector.\nIf you want to hack this thing you’ll have to decide whether you want to have to make and mount 4 separate pieces of control hardware, or to replace the cabling with a much thicker set of wires.\nPipetting arm\nLurking under the metal cover of the tool arm is a profusion of electronics. There’s a lot to do. An (infrared?) sensor to measure distance, and actuation of grabbing a tool, identifying it, pipetting up and down, and ejecting a tip.\nSelecting/using tools\nOne of the very impressive things about the epMotion robot is its ability to change tools during operation. It can choose from a variety of single channel and multichannel pipettes, and even a plate gripper.\nTools How does this process work?\nThe tool arm has two coaxial motors. One is, I believe, a simple DC motor with a very low gearing. It rotates a bit of metal internal to the arm which causes it to firmly grip whichever tool it is currently over. I’m not quite sure how the robot knows when this rotation is finished. My suspicion is that it detects the change in current flowing through the motor when the motor stalls at the end. Certainly if you disconnect this motor, the robot is able to detect that ‘the engine is not responding’, and informs you so.\nLooking up at the inside of the tool gripper to see how it works. When one examines the pipettes themselves one notices they have electrical contacts, but these are simply used to tell the robot which tool is in what place. The pipettes are in fact mechanical rather than electronic devices. They all have the same rotatable top-piece, and as this is spun by a stepper motor in the tool arm they aspirate/dispense liquid (or in the case of the gripper, grab and release). As this piece is rotated the tool begins to extend a rod out from it. Inside the tool-gripper this rod must make contact with a switch, and this is used to “home” the pipette to ensure the robot knows the position of the plunger.\nHomed tool with thin rod extended to make contact with switch. Electrical contacts for tool ID visible to the right. Prospects for customisation\nI’m going to pause my hardware work here, because it isn’t yet clear exactly what the application of the robot will be for me and I don’t want to destroy any necessary functionality.\nIf I had continued I would have one way or another tried to marry up the epMotion hardware with the open-source OpenTrons robot-control software. This basically means adapting the hardware such that one knows how to control it and then writing a custom driver for the OpenTrons software.\nI do think this is completely achievable. The video above already shows how 3-axis control is possible, using a standard CNC board. Controlling aspirate/dispense as a fourth axis should be similarly simple. If my understanding of how the tool interlock works is correct than that also wouldn’t be too challenging – one would just need to measure the current flowing through the motor. An even simpler strategy would just be to keep one tool locked onto the machine.\nOne decision one would have to make would be whether to have a single control board and have lots and lots of wires running to the tool-arm, or to use the existing ribbon cables and have a separate controller on the tool arm controlled over serial. I suspect the latter might be the better approach.\nMore generally, if I do this I will have to consider whether I want to be limited to expensive epMotion robot tips, the only ones compatible with any of these tools. I suspect the answer is no. In that case I might end up bolting an OT-2 electronic pipette to the pipetting arm, though this again loses the advantages of tool-changing. Or maybe I’ll go with something completely different like a vacuum pump and a peristaltic pump – we’ll see.\nIn general none of this looks trivial, and one is almost certainly better off just buying an inexpensive OT2. Still, it’s nice to have a better understanding of what is going on inside this intricately engineered machine.\n Update:\nIt has just occurred to me (another useful reason for writing things down) that there may be an easier and less invasive way to get control of this thing. If one can reverse engineer the serial control that the computer uses to control the Y-axis, Z-axis, tool interlock, aspiration tip ejection (and distance measuring) then one can get control of all of these without messing with their hardware. It seems possible that this could be achieved relatively simply (if they are sent in a text-based format) and when I have access to the machine again in 6 months time I will investigate. The 8 leads in the ribbon cable could be: V+, GND, Y-out, Y-in, Z-out, Z-in, pipette-out, pipette-in.\n","date":1546709915,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1546709915,"objectID":"2147ca9144b0d89af7a7202dc35e23cb","permalink":"/blog/2019/01/05/emotion-5075-teardown/","publishdate":"2019-01-05T17:38:35Z","relpermalink":"/blog/2019/01/05/emotion-5075-teardown/","section":"post","summary":"In my PhD lab we had an epMotion 5075 pipetting robot. I had a like/hate relationship with this machine. Like: it’s an impressive, precision-engineered, piece of hardware. Hate: the software is appalling.","tags":null,"title":"eMotion 5075 teardown","type":"post"},{"authors":null,"categories":["Uncategorized"],"content":"The state of the art in image generation is BigGAN.\nNow, some trained models have been made available, including the capacity to interpolate between classes. I made a colab to easily create animations from these.\nThey are pretty fun.\nWhat is more, they make it clear that the latent space clearly captures very meaningful shared properties across classes. The poses of quite different animals are conserved, and “cat eyes” clearly map onto “dog eyes” during interpolation. These sort of properties suggest that the network ‘understands’ the scene it is generating.\nHere are some more:\n(this one moves in latent space as well as class space, hence the change of pose:)\nChurches to mosques:\n       ","date":1542120717,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1542120717,"objectID":"998dadf51533566b5ff66d23841cdb58","permalink":"/blog/2018/11/13/biggan-interpolations/","publishdate":"2018-11-13T14:51:57Z","relpermalink":"/blog/2018/11/13/biggan-interpolations/","section":"post","summary":"The state of the art in image generation is BigGAN.\nNow, some trained models have been made available, including the capacity to interpolate between classes. I made a colab to easily create animations from these.\nThey are pretty fun.\nWhat is more, they make it clear that the latent space clearly captures very meaningful shared properties across classes. The poses of quite different animals are conserved, and “cat eyes” clearly map onto “dog eyes” during interpolation. These sort of properties suggest that the network ‘understands’ the scene it is generating.\n","tags":null,"title":"BigGAN interpolations","type":"post"},{"authors":null,"categories":["Uncategorized"],"content":"In the last post I introduced neural networks, generative adversarial networks (GANs) and InfoGANs.\nIn this post I’ll describe the motivation and strategy for creating a GAN which generates images of biological cells, like this:\nMotivation\nTwo microscopic of cells from an identical cell-line are never going to be pixel-for-pixel identical, yet they still share key similarities in terms of morphology. One way to get a computer to demonstrate it “understands” these morphological properties is to force it to create images of new cells. When a model is capable of generating any image that might be taken of a specific cell one might argue that it has gained some knowledge about the cell.\nThis is an appealing approach as it is is easy to acquire large numbers of static images of cells, for instance by using an imaging flow cytometer. This device flows cells past a camera and acquires thousands of images each second, each with a large number of fluorescent channels. These are static images of course, but if they come from an synchronous population they should contain representatives of every stage in the cell cycle. If our generative model was sufficiently capable of truly understanding the structure in the data (and there is evidence that such models do) then provided if we could generate a model where one dimension in our generator corresponded to pseudotime we could generate timecourse “videos” from models trained on these single images. This would, apart from anything else, have practical utility, avoiding the problems of photobleaching in imaging.\nWhat I did\nFrom my work at the Rayner lab at the Sanger Institute I have access to a large dataset of images of infected red blood cells acquired with an imaging flow cytometer. These images contain both a brightfield transmitted light channel and a fluorescent channel showing DNA in the parasite. I used some filtering (with a classification network) to isolate only images containing single cells which were fully visible. I then trained an InfoGAN in much the same way as in the digit dataset described in the last post.\nI tried a couple of different versions, one with a large number of “communicated” values – which is what you see above.\nThe network learns about quite a few aspects of Plasmodium\nbiology, and also some basic optics:\n It learns about red blood cell morphology and to produce images of plausible cells It learns that the nucleus in the DAPI channel is always within the bounds of the RBC in the brightfield channel. It learns that there are a subset of cells (schizonts) which have both black haemozoin, and widespread, bright DAPI nuclei (often arranged in a circular shape) It learns that cells can appear in front of or behind the focal plane and how to render both types. I could go on.. the images produced by the network are almost all entirely plausible images that a biologist would be unable to distinguish from true parasites.  As an aside I really like watching this network cycle between samples, it is strikingly similar to watching a motile cell wriggling:\nI also trained a second version, with many fewer communicated variables, which really lets us see what the network sees as the most salient features. Unsurprisingly, these are mostly about the location and orientation of the red blood cell. Interestingly this network makes one of the parameters the focal position of the cell:\nFor any cell you look at, one end of this variable produces one type of halo, and the other the opposite, just as if this parameter was controlling the focus of a microscope.\nThis property illustrates the sort of property it would be really exciting to get the network to learn. In an ideal world the sliders would represent something like: focus, cell orientation and parasite lifecycle stage. So if you had a young ring stage parasite and you wanted to watch it mature you could just drag the slider across. Or if you wanted to focus on the far side of the cell you could just drag another slider. Such an idea may sound fanciful, but I don’t think it’s too far away.\nThere are a number of simple ways I could improve the work I’ve done here. The network has to capture the complete distribution of cellular images presented as “real”. In this case you can see that these are in many different orientations, and different positions in the image. So a vast amount of the networks efoort goes into recapturing that, not very interesting, spatial variation. I made some basic attempts to align the images presented to the network, but this is something I could definitely improve. Something you will see as the cells dance from one space in the network to another is that while the nucleus tends to move smoothly around the black haemozoin will often fade out in one location and appear in another. The lack of smoothness here is an example of “modal collapse” that often haunts GANs, but there are a number of ways to tackle it.\nIn short, this work just scratches the surface of what what I suspect is possible with generative models of biological cells.\nIn some organisms there are genome-wide fluorescent-tag libraries available. Building a generative model using these (possibly with the need for some pairwise imaging) could allow the creation of a synthetic cell in which every protein can be simultaneously visualised. It’s an exciting prospect, and I think it’s nearer than it seems.\nP.S. I belatedly looked for similar published work, and found two cool papers. The second of these introduces a star-shaped network designed to allow alignment in much the way I imagine at the end of this post. And more generally there are a ton of GAN papers applying the technique to super-resolution microscopy, in silico staining, etc.\n","date":1538474706,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1538474706,"objectID":"020048b9762db95f9a60b94c782d0b73","permalink":"/blog/2018/10/02/adventures-with-infogans-towards-generative-models-of-biological-images-part-2/","publishdate":"2018-10-02T10:05:06Z","relpermalink":"/blog/2018/10/02/adventures-with-infogans-towards-generative-models-of-biological-images-part-2/","section":"post","summary":"In the last post I introduced neural networks, generative adversarial networks (GANs) and InfoGANs.\nIn this post I’ll describe the motivation and strategy for creating a GAN which generates images of biological cells, like this:\n","tags":null,"title":"Adventures with InfoGANs: towards generative models of biological images (part 2)","type":"post"},{"authors":null,"categories":["Uncategorized"],"content":"I recently began an AI Residency at Google, which I am enjoying a great deal. I have been experimenting with deep-learning approaches for a few years now, but am excited to immerse myself in this world over the coming year. Biology increasingly generates very large datasets and I am convinced that novel machine-learning approaches will be essential to make the most of them.\nAt the beginning of my residency, I was advised to complete a mini-project which largely reimplements existing work, as an introduction to new tools. In this post I’m going to describe what I got up to during that first few weeks, which culminated in the tool below that conjures up new images of red blood cells infected with malaria parasites:\n function resizeIframe(obj) { obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px'; } \n\nI’m going to try to explain it from first principles, which might take a while, so if you have a background in machine-learning, skip to the next post.\nNeural net-what?\nDeep learning is based around things called neural networks. A neural network takes a series of numbers in, does some processing to them, and ultimately spits out another set of numbers. A system like this is in theory capable of undertaking a great many tasks: for example the first series of numbers could be the brightness values for each pixel in an image, and the number outputted could be the probability that the image contains a cat. If the network can map those sets of numbers to each other successfully, then you have a cat-recognition network.\nA hypothetical classification network to detect images of cats But what determines whether the network will recognise cats, koalas, or fail to recognise anything at all? Each network contains a vast array of parameters, which determine how the input numbers are processed to produce the output. These are knobs which can be twiddled to make the network do different things.\nThe magic that makes neural networks powerful is a process called back-propagation, which allows the system to automatically twiddle these knobs until the network produces the desired output for each input. This requires a large amount of labelled data. For our cat network we might give it 1,000 photos of cats, and 1,000 photos of dogs. The system will start off by setting the parameters to random values. It will then feed in the first cat photo and see what number it gets out. With these random values, the network will most likely output 0.5 as the cat probability, even though the true value is 1 (it’s a cat!). But with back-propagation the system can observe this error (0.5 – 1 = -0.5) and calculate which direction it needs to turn each knob (and by how much) to make the error smaller. If we repeat this process over and over and over again (which is called training), we will eventually we find we have a network that can reliably distinguish cats and dogs. And it turns out that the graphics cards in our computers can be commandeered to make that process happen pretty quickly. In an hour or so we can have our cat recognition network – jubilations.\nWith those basic principles one can build a network to do any sort of classification problem. If you have searched your own photos based on what they contain (e.g. on Google photos) then you have interacted with just such a network.\nMaking computers creative\nYou might think at this point that our network has a pretty good idea what a cat looks like, but unfortunately with this approach you can’t ask it to draw one.\nOne can imagine a neural network which could draw, however: this time the output would be a series of numbers, which we will convert into to the brightness values of pixels in an image. What should the input be? It turns out we can just use random numbers: for each image we can sample say 10 values from a normal distribution, and feed them in. That way, in theory, the network can draw on this randomness to generate a different picture each time, and act as an image generator.\nThere is a problem of course. The network still has no idea what cats look like. When it is created, with its knobs set to random positions, it will generate images that resemble those on an un-tuned TV. In theory we could train it ourselves, by letting it know whenever it produced noise that had the faintest of resemblance to a cat, until it was coaxed into doing what we wanted. In practice however, this would take an eternity.\nSo what to do? Well, there’s a trick, invented just four years ago, which has been revolutionary. We can introduce a second network, called a discriminator. This is a classification network, like the one we imagined above. But this time its task is not to distinguish cats from dogs, but to distinguish real photos of actual cats, from fake cats imagined by the generator. We feed it some real cats, and some fake ‘cats’ that the generator has produced, and we train it. Initially it has a very easy job here, since remember the generator is just displaying the images of an untuned TV. But wait..\nOnce the discriminator starts to do a decent job we can take our back-propagation one step further. The system can backpropagate from the final result (“fake” or “real”) back to the pixel values produced by the generator, and then all the way back through the generator to the random variables that made these fake images. Then it can ask “what directions should I turn the knobs of the generator so that it produces an output that the discriminator thinks is real?”. In this way, the generator can be trained to fool the discriminator, and in doing so, the images it produces will become a bit more cat-like.\nThe discriminator can now be trained again, to be more expert in telling these synthetic cats from their real counterparts. In fact we bounce back and forth, training generator and then discriminator in a continual loop. They have opposing goals, the generator wants to make realistic cat images and the discriminator wants to tell these apart from true cat images, and so this architecture is called a generative adversarial network or GAN. After a long period of training these networks can produce results like these:\nResults of a cat GAN. (This figure comes from a [paper][4] by Alexia Jolicoeur-Martinea about a novel type of discriminator) And with some extensions of the GAN approach [Nvidia][5] were able to hallucinate these wholly imaginary celebrities. Not bad, eh?\nInfoGAN – images that communicate information\nThis approach can produce realistic images. But the relationship between the random noise at the beginning and the image at the end is not generally clear. If we increase value 3 by 50% what will happen? It is generally difficult to predict, and does not correspond in a useful way to a semantically meaningful property of the image.\nThere would be a lot of value to a network which, without being specifically trained to, could actually understand the structure in these images (e.g. that there are different breeds of cat) and that at the end could generate an image of any breed of your choice.\nSome people came up with a very clever way of doing this, called an InfoGAN. This approach is very similar to the original GAN. The generator still draws on random noise to produce its image. However the generator is also given some extra noise, which it is tasked with encoding into the image it produces. For instance in the original InfoGAN paper the researchers produced a network which made images of hand-written digits. The extra noise they added was a discrete ‘one-hot’ variable with ten possible values. The idea was to create a network where each of these values corresponded to a different digit. To get this to happen they created an additional training objective for both the generator and the discriminator. As before, the discriminator still wants to distinguish real images from fake images and the generator still wants to fool the discriminator. However both the discriminator and the generator are also rewarded if the discriminator is able to successfully reconstruct the extra random variable that was fed to the generator.\nThis means the generator now has to encode information (a variable with ten possible values) into an image, but that image has to be a plausible member of the set of hand-written digit images. The strategy that it ends up taking is to encode each value as a separate digit, and tada, we have achieved our goal. We can now ask the network to generate any specific digit we like. We can choose threes and generate an infinite number of different threes in different styles. The researchers also showed that if they added two more continuous variables to be communicated, these ended up mapped to the angle, and the width, of the digit produced.\n Figure from the InfoGAN paper showing the three properties the network has learnt (digit type, angle and width) I began by reimplementing some of what these researchers had achieved, focusing on this hand-written digit task. Here are the images my network produced evolving over time:\nYou can see the network gradually deciding how it will encode each value. It is undecided about what should be a five and what should be a zero for a long time, but it eventually comes to a conclusion. So without labelling any of the data, the system has learnt to partition it into ten appropriate categories, and has built a system for arbitrarily generation members of each of these categories.\nThere are a near-infinite number of possible threes that can be drawn – cleaner or curlier, thicker or thinner, but all are united in being threes. I think that a very similar property applies in biological cells and in the next post I’ll describe my forays into this area, and the promise I think such an approach holds.\n\u0026raquo;\u0026raquo; Part 2\n","date":1538470846,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1538470846,"objectID":"bffc5ca71df553dcd9d074cf83e2cf95","permalink":"/blog/2018/10/02/adventures-with-infogans-towards-generative-models-of-biological-images/","publishdate":"2018-10-02T09:00:46Z","relpermalink":"/blog/2018/10/02/adventures-with-infogans-towards-generative-models-of-biological-images/","section":"post","summary":"I recently began an AI Residency at Google, which I am enjoying a great deal. I have been experimenting with deep-learning approaches for a few years now, but am excited to immerse myself in this world over the coming year.","tags":null,"title":"Adventures with InfoGANs: towards generative models of biological images (part 1)","type":"post"},{"authors":null,"categories":["Uncategorized"],"content":"Sometimes in science you come across things that are definitely interesting, and useful, but which you don’t have time to write up properly for one reason or another. I’m going to try to get into the habit of sharing these as blog-posts rather than letting them disappear. Here is one such story.\n Not long ago I was searching for orthologs of a malaria gene of interest on the NCBI non-redundant database, which allows one to search across the entire (sequenced) tree of life. Here is a recreation of what I saw:\nI was surprised to see that nestled among the Plasmodium species was a sequence from a species called Piliocolobus tephrosceles.\nA web search revealed this to be the linnaean name for the Ugandan red colobus monkey. Odd that this monkey should have a gene so similar to one from a parasite, eh? But there are some weird misannotations on NCBI. However a bit later I saw the same thing happen again with another gene, and thought something must be going on. I tried more malaria genes and found I could almost always find a strong match in the colobus assembly.\nI navigated through NCBI to find some more about this particular monkey.\nThe page tells us that this monkey from which this genome was sequenced was found here, in the depths of Kibale National Park (it was sequenced for a University of Oregon genome study, in prep.):\nIt also tells us that the sequence came from whole blood. This methodology seemed to be consistent with researchers serendipitously acquiring sequence from a blood-borne parasite in the process of sequencing the monkey genome.\nJust how much of this genome is there in the colobus sample? I downloaded the assembly to find out. The assembly was broken up into 47,644 contigs. My hypothesis was that some of these represented monkey sequence and others represented this sequence of a malaria-like parasite. I calculated the GC content of each contig and plotted a distribution:\nPlasmodium spp. have a much lower GC-content than mammalian species, and from this it looks like whatever species we have here shows this same bias. Just to be sure I also searched each “colobus” contig with Diamond (a faster Blast-like tool) against all protein sequences of the rhesus macaque and of P. vivax. If a contig had a significantly higher score in P. vivax than rhesus it was assigned to that species and vice versa. Overlaying this data was pretty compelling:\nI decided that by taking contigs which were either significantly better matches to P. vivax, or alternatively had a GC content below 24%, I would get a genome which was almost entirely this intriguing species. This gave me 13,460 contigs representing about 30 Mbp of sequence (Plasmodium genomes are 20-30 Mbp so this could potentially be a genome’s worth – although I don’t always get BLAST matches, so I suspect it is somewhat less). I also got in touch with the person named in the NCBI accession to see if they were already investigating these:\nhey @theosanderson not specifically on the hepatocystis seqs in the assembly, though collaborators in our group have done some interesting work on hepatocystis in red colobus themselves https://t.co/yLs6ycTYrv  — Noah Simons (@noahdsimons) April 5, 2018  My home institute has released a rather neat web tool called Companion, which allows you to upload a series of genomic contigs and have them annotated with reference to a known genome using a whole pipeline of analysis. (Unfortunately it only accepts up to 3,000 sequences. But you can download it as a Docker container to circumvent that restriction).\nHere are the results from its run on these sequences. Companion identifies \u0026gt;2000 genes, including such favourites as circumsporozoite protein, GAP50, PTEX88 and the SERAs. It nicely annotates a pseudochromosome-based version of the genome (although I’m not sure it’s taking full advantage of the synteny at the moment).\nSo what is this mysterious species?\nIt clearly isn’t an already sequenced Plasmodium species. A bit of googling suggested to me that it might be some species of Hepatocystis, which are known to infect red Colobus. Hepatocystis seems in some ways to be an unnecessary genus, since the latest phylogenies show that evolutionarily it lies nested within Plasmodium, being more closely related to mammalian Plasmodium species than is the avian malaria parasite Plasmodium gallinaceum. But there are reportedly important differences of approach between the groups – hepatocystis seems to lack the asexual cycle, with replication occurring only in the liver. One might hypothesise that this would lead to substantial loss of intra-erythrocytic genes. Also these beasts are transmitted by midges rather than mosquitoes (that data the result of a decade–long search). There are no other genome-scale sequencing datasets available for hepatocystis.\nI searched GenBank for targeted hepatocystis sequences, and found a few, including the caseinolytic protease C gene which has been sequenced from numerous bat isolates. I found the matching sequences for these in the Colobus assembly and then Blasted those sequences back against GenBank to recover a set of sequences to analyse. Constructing a tree with Phylogeny.fr seemed to demonstrate clearly that this is some species of hepatocystis:\nThe closest relative found here is from a Cynopterus brachyotis bat from Singapore – bats seem to pick up everything!\nThis is about as far as I’ve got with this. Some thoughts at this point:\n If you are interested in what a specific gene looks like in hepatocystis it is likely that you can find at least part of it in these colobus contigs to compare to. It is very easy to run a BLAST search at NCBI to check. Early data-release is awesome! Parasitologists will really benefit from the University of Oregon primate researchers making this data available. Someone should really see if we can get a really decent genome from these short read sequences. The library was prepared with Chromium technology and assembled with SuperNova, a 10X assembler. Is it possible these methods are optimised for diploid sequences and that assembling the raw data might enable a better parasite assembly? Or maybe the current assembly is pretty good – apart from the gaps – and missing _Plasmodium _genes are truly missing due to the differences in the hepatocystis lifecycle? The depositors of the assembly might wish to partition it into its monkey and hepatocystis portions as I have above, lest a lot of parasite researchers are going to get confused when they find their parasite to be so closely related to a monkey 🙂 Happy to share my assignments! ","date":1524505150,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1524505150,"objectID":"9e0f63d9087ef4b2bac4c9b1c52b544d","permalink":"/blog/2018/04/23/how-i-stumbled-upon-a-novel-genome-for-a-malaria-like-parasite-of-apes/","publishdate":"2018-04-23T17:39:10Z","relpermalink":"/blog/2018/04/23/how-i-stumbled-upon-a-novel-genome-for-a-malaria-like-parasite-of-apes/","section":"post","summary":"Sometimes in science you come across things that are definitely interesting, and useful, but which you don’t have time to write up properly for one reason or another. I’m going to try to get into the habit of sharing these as blog-posts rather than letting them disappear. Here is one such story.\n Not long ago I was searching for orthologs of a malaria gene of interest on the NCBI non-redundant database, which allows one to search across the entire (sequenced) tree of life. Here is a recreation of what I saw:\nI was surprised to see that nestled among the Plasmodium species was a sequence from a species called Piliocolobus tephrosceles.\n","tags":null,"title":"How I stumbled upon a novel genome for a malaria-like parasite of primates","type":"post"},{"authors":null,"categories":["Uncategorized"],"content":"**TL;DR: **Some 3D-printing hackery can create an automated microscope stage from a manual stage for ~0.5% of the cost from the manufacturer.\n I have always wanted access to a microscope with an automated stage. The ability to scan an entire slide/plate for a cell of interest seems to unlock a wealth of new possibilities.\nSadly, these systems cost quite a bit. The lab I work in now has a Leica DMi8 microscope with automated movement in Z. But XY movement is (on our model) still manual. It is possible to purchase an automated XY stage for this microscope, but the list-price quote is around £12,000 (including stage, and control hardware and software).\nI’m not going to argue that this price is unreasonable. I am sure that the manufacturers of scientific equipment spend a lot of time and money innovating, and that money has to be made back by selling devices which have relatively small production runs. Nevertheless, the result is that the costs of kit that makes it to market are fairly staggering – and this prevents someone like me from being able to play around with an automated stage.\nBut I still wanted to experiment with an automated stage! So I wondered how easy this would be to do myself. After all, we have a manual stage, and we move it by rotating two knobs. Couldn’t I just get motors to turn those instead of doing it with my hand?\nAs I thought this through further I realised it was slightly complicated than this. Firstly, the knobs are co-axial, making them rather harder to deal with than would be two separate shafts. And secondly, as you rotate the X-knob, the shaft moves in X.\nSo the motors need to be able to move with it. But they also need to be to rotate and exert a twisting force on the knob – so they need to move linearly but be locked in one orientation.\nHardware: 3D printed pieces, 2 stepper motors and a RAMPS controller\nI made a quick design in OpenSCAD\nBasically the first knob,which controls movement in Y, is simply connected to the mechanism by a (red) sleeve which connects to a motor below. The knob above, which controls movement in X, is placed inside a (blue) sleeve which covers it in a gear. That gear is turned by a (turquoise) gear turned by a second motor. Both motors are mounted on a (transparent) piece which also connects them to a LM6LUU linear bearing which allows them to slide but keeps their orientation constant.\nI printed out these 3 pieces – then tweaked the dimensions a little to be more snug on the knobs and printed them again. The final STL files, and the SCAD file that generated them are available on Thingiverse.\nTo control it I connected the steppers to a trusty RAMPS 3D printer controller. These cost £30 with a screen and a rocker controller (the Leica hardware to control a stage is ~£3k). Since the 3D printer controller is also all set up to control the temperature of a hot-end and a heated bed, if you want to add warm stage down the line this might be ideal.\nInitial tests controlling the position using the system using the RAMPS controller went well, and let me calibrate the number of steps per micrometer.\n\nSoftware: MicroManager Regrettably, the Leica software isn’t going to allow you to easily hook it up to an Arduino-based controller. But, as ever, open-source software comes to the rescue. Micro-Manager is a very advanced ImageJ plugin that can connect to the Leica camera, and to the microscope itself to control filter cube positions, Z-focusing, etc.\nDon’t expect quite the user-friendliness of Leica software from Micro-Manager, but _do _expect a wealth of packages to perform common operations in automated-microscopy (Leica charges ~£2.5k for the software to revisit a position multiple times – which was included in the quote given above).\nTheoretically, MicroManager even allows you to control XY position using a RAMPS controller – someone has already written a package for exactly this board. This step, which should have been trivial, was actually the most complicated. The device adapter is designed to ask the RAMPS controller for its version, and somehow I could never make my board submit a response that the software was happy with. I had to download the MicroManager source and remove the code that checked the version. Successfully setting up the build environment for Windows took an age. Do get in touch if you have a similar project and want the DLL I built [update: DLL here, I offer no guarantees at all that it will work. This is an x64 build which will only work with a recent nightly build] [update 2: Nikita Vladimirov has followed up on this and released the changes he had to make to MicroManager]. Anyway, to cut a long story short I got MicroManager to talk to the RAMPS board successfully.\nTesting by making a 100X oil immersion slide scanner Now to put it into practice.\nI wrote a Beanshell script to scan a slide in X and Y and capture images. In this case I captured images in a grid 40 microscope images wide by 30 microscope images high, for a total of 1200 images.\n\nThis took a few minutes – try doing that by hand.. Then I stitched them together with the MIST plugin. The result is a 27,000 x 12,000 pixel image, featuring a whole lot of red blood cells. You can zoom in on the version below. This was taken with a 100X oil immersion objective, at which magnification the smallest motion of the stage is a substantial fraction of the image, but still allows enough overlap for stitching.\n\n Fun! Still a bit more experimenting to do, but I’m hoping to get this acquiring tagged proteins from 96-well plates.\nCaveat for anyone who tries to implement this: obviously be very careful not to create significant non-twisting forces on the coaxial knobs – you don’t want to damage your stage and ruin the alignment.\n","date":1517495441,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1517495441,"objectID":"fb39970aae35f35c64b930b9a90207a0","permalink":"/blog/2018/02/01/save-99-5-upgrading-a-manual-microscope-with-an-automated-stage-for-60/","publishdate":"2018-02-01T14:30:41Z","relpermalink":"/blog/2018/02/01/save-99-5-upgrading-a-manual-microscope-with-an-automated-stage-for-60/","section":"post","summary":"**TL;DR: **Some 3D-printing hackery can create an automated microscope stage from a manual stage for ~0.5% of the cost from the manufacturer.\n I have always wanted access to a microscope with an automated stage.","tags":null,"title":"Saving 99.5%: automating a manual microscope with a 3D printed adapter","type":"post"},{"authors":null,"categories":["Uncategorized"],"content":"Thesis PDF\n","date":1511614447,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1511614447,"objectID":"85199428e44e459f11903457921123bd","permalink":"/blog/2017/11/25/hello-world/","publishdate":"2017-11-25T12:54:07Z","relpermalink":"/blog/2017/11/25/hello-world/","section":"post","summary":"Thesis PDF","tags":null,"title":"New beginnings","type":"post"},{"authors":["Ellen Bushell","Ana Rita Gomes","Theo Sanderson","Burcu Anar","Gareth Girling","Colin Herd","Tom Metcalf","Katarzyna Modrzynska","Frank Schwach","Rowena E. Martin","Michael W. Mather","Geoffrey I. McFadden","Leopold Parts","Gavin G. Rutledge","Akhil B. Vaidya","Kai Wengelnik","Julian C. Rayner","Oliver Billker"],"categories":null,"content":"","date":1498867200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1498867200,"objectID":"03652ed8297759f540c4706503640f92","permalink":"/publication/2017-functional_profiling/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/2017-functional_profiling/","section":"publication","summary":"In this work we conducted the first genome-scale genetic screen in a malaria parasite. We found that malaria parasites have require a higher proportion of their genome for normal growth compared to any other eukaryote previously screened. I led the analysis portion of this work, including building the [dashboard](https://plasmogem.sanger.ac.uk/phenotypes) used by the community to access our phenotype data.","tags":[],"title":"Functional profiling of a Plasmodium genome reveals an abundance of essential genes","type":"publication"},{"authors":["Theo Sanderson","Julian C. Rayner"],"categories":null,"content":"","date":1498867200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1498867200,"objectID":"8650812bf60f4c622e35760e0bedf18a","permalink":"/publication/2017-phenoplasm/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/2017-phenoplasm/","section":"publication","summary":"[PhenoPlasm](http://www.phenoplasm.org) is a database of all disruption phenotypes in malaria parasites. I conceived of, designed, created and continue to curate the database.","tags":[],"title":"PhenoPlasm: a database of disruption phenotypes for malaria parasite genes","type":"publication"},{"authors":null,"categories":["Projects"],"content":"The houses of parliament in the UK host a website of petitions. When a particularly popular petition is trending it can be addictive to refresh the page and watch the numbers going up behind your eyes. But of course what one really wants is a graph.\nSo I built this tool which regularly queries the parliament API and stores historical petition signatures in a database which it uses to draw graphs.\n","date":1484523958,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1484523958,"objectID":"47627a0ac7e46f649c3903b03d5e23a0","permalink":"/blog/2017/01/15/petition-grapher/","publishdate":"2017-01-15T23:45:58Z","relpermalink":"/blog/2017/01/15/petition-grapher/","section":"post","summary":"The houses of parliament in the UK host a website of petitions. When a particularly popular petition is trending it can be addictive to refresh the page and watch the numbers going up behind your eyes.","tags":null,"title":"Petition grapher","type":"post"},{"authors":null,"categories":null,"content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"e8f8d235e8e7f2efd912bfe865363fc3","permalink":"/project/example/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/example/","section":"project","summary":"An example of using the in-built project page.","tags":["Deep Learning"],"title":"Example Project","type":"project"},{"authors":null,"categories":["Projects","Sci-comm"],"content":"When Randall Monroe released the amazing Up-Goer Five comic, I was inspired to hack together a customised editor so that I could explain my own research in the limited vocabulary of the thousand most common words.\nFor me the most exciting bit about this was that I got an email from Mr. xkcd himself. It also became a bit of a science-communication craze. A lot of scientists got in on the action (some kind people have made a collection here).\nThe editor has featured in The Guardian (and again). More recently it’s even been used for conference sessions, which are pretty fantastic. (The 9th talk in that playlist is particularly excellent). It’s also quite popular as a science communication training exercise, although it goes without saying that no-one is suggesting that this is the best way to communicate.\n","date":1358281809,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1358281809,"objectID":"bb18ad393cc780386c4d972d90224af2","permalink":"/blog/2013/01/15/the-up-goer-five-text-editor/","publishdate":"2013-01-15T20:30:09Z","relpermalink":"/blog/2013/01/15/the-up-goer-five-text-editor/","section":"post","summary":"When Randall Monroe released the amazing Up-Goer Five comic, I was inspired to hack together a customised editor so that I could explain my own research in the limited vocabulary of the thousand most common words.","tags":null,"title":"The Up-Goer Five Text Editor","type":"post"},{"authors":null,"categories":["Projects"],"content":"The international genetic engineered machine competition (iGEM) was my first taste of proper experimental science, and I still have a fondness for synthetic biology. I was part of the Cambridge Team for 2010. This was an exciting team project where we got to define our own genetic engineering project and work on it over a summer.\nWe focused on bioluminescence, building modular genetic components (BioBricks) from firefly luciferase, in a number of colours, and also from the bacterium Vibrio fischeri. The exciting thing about the bacterial luciferase is that this permits ‘autoluminescence’, i.e. the bacteria produce light without adding any other chemicals. We exploited this to light ourselves in the photo below.\nIn the project we achieved a Gold Medal, were finalists in the competition and won the prize for Best Wiki, which I designed. As part of the project I built BioBrick2GenBank, a small tool which converts BioBricks to GenBank format for editing in standard cloning software. This has been used \u0026gt;350,000 times to date.\nOur BioBricks have been used by a number of future teams, including by a team from Peking, who used this part in one bacterium, combined with a light sensitive-system in bacteria in a separate tube, to allow cell-cell communication!\nGibson assembly\nWe were also early users of the revolutionary Gibson Assembly protocol, and I penned the lyrics to the embarassing music-video we made to promote it, earning us the (dubious?) distinction of a Craig Venter tweet.\nMedia\nOn the back of this project I was quoted in New Scientist, and later by the BBC.\nBook chapter\nBen Reeve and I later wrote a chapter about the application of bioluminescence in synthetic biology.\n","date":1281900784,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1281900784,"objectID":"b545dbfaa7f464ad85232be9938dae87","permalink":"/blog/2010/08/15/igem/","publishdate":"2010-08-15T19:33:04Z","relpermalink":"/blog/2010/08/15/igem/","section":"post","summary":"The international genetic engineered machine competition (iGEM) was my first taste of proper experimental science, and I still have a fondness for synthetic biology. I was part of the Cambridge Team for 2010.","tags":null,"title":"iGEM","type":"post"},{"authors":null,"categories":null,"content":"","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"5a3203ae0b543fa13e16b6757e5f2a48","permalink":"/medialist/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/medialist/","section":"","summary":"","tags":null,"title":"","type":"widget_page"},{"authors":null,"categories":null,"content":"","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"b2e1e682ded2cf71d25fa57af0bd1fe8","permalink":"/media/bla/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/media/bla/","section":"media","summary":"","tags":null,"title":"BBC article","type":"media"},{"authors":null,"categories":null,"content":"","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"32f84de128d56f5adb1ede3e5f694c7c","permalink":"/media/bla2/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/media/bla2/","section":"media","summary":"","tags":null,"title":"BBC article 2","type":"media"}]